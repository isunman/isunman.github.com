<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Sunman，太阳侠" />





  <link rel="alternate" href="/atom.xml" title="太阳侠" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description" content="love IT, love Movie, love Love">
<meta property="og:type" content="website">
<meta property="og:title" content="太阳侠">
<meta property="og:url" content="http://isunman.com/index.html">
<meta property="og:site_name" content="太阳侠">
<meta property="og:description" content="love IT, love Movie, love Love">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="太阳侠">
<meta name="twitter:description" content="love IT, love Movie, love Love">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: undefined,
      author: '博主'
    }
  };
</script>

  <title> 太阳侠 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?edc09d74f003ef7b14a37137efc44fd4";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>






  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">太阳侠</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">我是一颗恒星</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      

      
      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">

    

    
    

    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2023/05/16/talk-about-teamwork-and-collaboration-tools/" itemprop="url">
                  聊聊团队协同和协同工具
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2023-05-16T17:04:00+08:00" content="2023-05-16">
              2023-05-16
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/产品研究/" itemprop="url" rel="index">
                    <span itemprop="name">产品研究</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这两天跟 Cali 和 Rather 做了一个线上的 Podcast – Ep.5 一起聊聊团队协同。主要是从 IM 工具扩展开来聊了一下团队的协同和相应的工具，但是聊天不是深度思考，有一些东西我没有讲透讲好，所以，我需要把我更多更完整更结构化的想法形成文字。（注：聊天聊地比较详细，本文只是想表达我的主要想法）</p>
<h2 id="国内外的企业-IM-的本质差别"><a href="#国内外的企业-IM-的本质差别" class="headerlink" title="国内外的企业 IM 的本质差别"></a>国内外的企业 IM 的本质差别</h2><p>国内企业级在线交流工具主要有：企业微信、钉钉、飞书，国外的则是：Slack、Discord这两大IM工具，你会发现，他们有很多不一样的东西，<strong>其中有两个最大的不同，一个是企业管理，一个是企业文化。</strong></p>
<h3 id="企业管理"><a href="#企业管理" class="headerlink" title="企业管理"></a>企业管理</h3><p><strong>Slack/Discrod 主要是通过建 Channel ，而国内的IM则主要是拉群。</strong>你可能会说，这不是一样的吗？其实是不一样的，很明显，Channel 的属性是相对持久的，而群的属性则是临时的，前者是可以是部门，可以是团队，可以是项目，可以是产品，可以是某种长期存在的职能（如：技术分享），而拉群则是相对来说临时起意的，有时候，同样的人群能被重复地拉出好几次，因为之前临时起意的事做完了，所以群就被人所遗忘了，后面再有事就再来。<strong>很明显，Channel 这种方式明显是有管理的属性的，而拉群则是没有管理的。</strong></p>
<p>所以，在国内这种作坊式，野蛮粗放式的管理风格下，他们需要的就是想起一出是一出的 IM 工具，所以，拉群就是他们的工作习惯，因为没有科学的管理，所以没有章法，所以，他们不需要把工作内的信息结构化的工具。而国外则不然，国外的管理是精细化的，国外的公司还在重度使用 Email 的通讯方式，而 Email 是天生会给一个主题时行归类，而且 Email 天生不是碎片信息，所以，国外的 IM 需要跟 Email 竞争，因为像 Email 那样给邮件分类，把信息聚合在一个主题下的方式就能在 IM 上找到相关的影子。Channel 就是一个信息分类，相当于邮件分类，Slack 的 回复区和 Discord 的子区就像是把同一个主题信息时行聚合的功能。这明显是懂管理的人做的，而国内的拉群一看就是不懂管理的人干的，或者说是就是满足这些不懂管理的人的需求的。</p>
<h3 id="企业文化"><a href="#企业文化" class="headerlink" title="企业文化"></a>企业文化</h3><p>团队协作和团队工作最大的基石是信任，如果有了信任，没有工具都会很爽，如果没有信任，什么工具都没用。信任是一种企业文化，这种文化不仅包括同级间的，还包括上下级间的。但是，因为国内的管理跟不上，所以，就导致了各种不信任的文化，而需要在这里不信任的文化中进行协同工作，国内的 IM 软件就会开发出如下在国外的 IM 中完全没有的功能：</p>
<ul>
<li><strong>监控员工。</strong>获取员工的工作时间以及工作位置。</li>
<li><strong>有详细的已读标注。</strong>这样会给对方要回复的压力。</li>
<li><strong>发出的信息不能修改，不能删除，非常有限地可撤回。</strong></li>
</ul>
<p>而国外的 IM 则是，发出的信息可以修改/删除，没有已读标准，也不会监控员工。这种时候，我总是会对工作在这种不信任文化中人感到可怜……如果大家需要靠逼迫的方式把对方拉来跟我一起协作，我们还工作个什么劲啊。</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>所以，我们可以看到，<strong>畸形的企业管理和企业文化下，就会导致畸形的协同工具。</strong>最令人感到悲哀的是，有好多同学还觉得国内的钉钉非常之好，殊不知，你之所以感觉好用，是因为你所在的环境是如此的不堪。你看，<strong>人到了不同的环境就会有不同的认识，所以，找一个好一些的环境对一个人的成长有多重要。</strong></p>
<p>给一些新入行的人的建议就是，一个环境对一个人的认知会有非常大的影响，找一个好的环境是非常重要，如果不知道什么 环境是好的，那就先从不使用钉钉为工作协同软件的公司开始吧……</p>
<h2 id="什么是好的协同工具"><a href="#什么是好的协同工具" class="headerlink" title="什么是好的协同工具"></a>什么是好的协同工具</h2><p>我们从上面可以得到，协同的前提条件是你需要有一个基于信任的企业文化，还需要有有结构化思维的科学的管理思维。没有这两个东西，给你的团队再多的工具都不可能有真正好有协同的，大家就是装模作样罢了。</p>
<p>假设我们的管理和文化都没有问题，那下面我们来谈谈协同工具的事。</p>
<p>我个人觉得 IM 这种工具包括会议都不是一种好的协同工具，因为这些工具都无法把信息做到真正的结构化和准确化，用 IM 或是开会上的信息大多都是碎片化严重，而且没有经过深度思考或是准备的，基本都是即兴出来的东西，不靠谱的概率非常大。</p>
<p>找人交流和开会不是有个话题就好的，还需要一个可以讨论的“议案”。在 Amazon 里开会，会前，组织方会把要讨论的方案打印出来给大家看，这个方案是深思过的，是验证过的，是有数据和证据或是引用支撑的，会议开始后，10 -15分钟是没有人说话的，大家都在看文档，然后就开始直接讨论或发表意见，支持还是不支持，还是有条件支持……会议效率就会很高。</p>
<p>但是这个议案其实是可以由大家一起来完成的，所以，连打印或是开会都不需要。试想一下，使用像 Google Doc 这样的协同文档工具，把大家拉到同一个文档里直接创作，不香吗？我在前段时间，在公网上组织大家来帮我完成一个《非常时期的囤货手册》，这篇文章的形成有数百个网友的加持，而我就是在做一个主编的工作，这种工作是 IM 工具无法完成的事。与之类似的协同工具还有大家一起写代码的 Github，大家一起做设计的 Figma……这样创作类的协同工具非常多。另外，好多这些工具都能实时展示别人的创作过程，这个简直是太爽了，你可以通过观看他人创作过程，学习到很多他人的思路和想法，这个在没有协同工具的时代是很难想像的。</p>
<p>好的协同工具是可以互相促进互相激励的，就像一个足球队一样，当你看到你的队友在勇敢地争抢，拼命地奔跑，你也会被感染到的。</p>
<p>所以，<strong>好的协同就是能够跟一帮志同道合，有共同目标，有想法，有能力的人一起做个什么事。所以，在我心中我最喜欢的协同工具从来都是创作类的，不是管理类的，更不是聊天类的。</strong>管理和聊天的协同软件会让你产生一种有产出的假象，但其实不同，这种工具无论做的有多好，都是支持性的工具，不是产出类的工具，不会提升生产力的。</p>
<p>另外，在创作类的协同工具上如果有一些智能小帮手，如：Github 发布的 Copilot。那简直是让人爽翻天了，所以，真正能提升生产力的工具都是在内容上帮得到你的。</p>
<h2 id="结束语"><a href="#结束语" class="headerlink" title="结束语"></a>结束语</h2><p>我其实并不喜欢今天所有的 IM 工具，因为我觉得信息不是结构化的，信息是有因果关系和上下文的，是结构化的，是多维度的，不是今天这种线性的方式，我们想像一下“脑图”或是知识图，或是 wikipedia 的网关的关联，我们可能就能想像得到一个更好的 IM 应该是什么 样的……</p>
<p>协同工作的想像空间实在是太大了，我觉得所有的桌面端的软件都会被协作版的重写，虽然，这种协作软件需要有网络的加持，但是协作软件的魅力和诱惑力实在的太大了，让人无法不从……</p>
<p>未来的企业，那些管理类的工具一定会被边缘化的，聊天类的会被打成一个通知中心，而创作类的会大放异彩，让大家直接在要干的事上进行沟通、交互和分享。</p>
<p>（全文完）</p>
<p>原文链接：<a href="https://coolshell.cn/articles/22298.html" title="聊聊团队协同和协同工具" target="_blank" rel="external">聊聊团队协同和协同工具</a></p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2022/08/21/How-to-use-FSOCKOPEN-in-PHP-to-achieve-asynchronous-request-and-response-status-code-499/" itemprop="url">
                  PHP中怎么使用fsockopen实现异步请求与响应状态码499
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2022-08-21T01:46:00+08:00" content="2022-08-21">
              2022-08-21
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/web构建/" itemprop="url" rel="index">
                    <span itemprop="name">Web构建</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="问题："><a href="#问题：" class="headerlink" title="问题："></a>问题：</h3><p>在PHP中使用fsockopen实现异步请求时，发现请求有发出，但是响应不是200而是499，导致被请求脚本并未按要求执行。</p>
<h3 id="这个问题的起源与解决方案。"><a href="#这个问题的起源与解决方案。" class="headerlink" title="这个问题的起源与解决方案。"></a>这个问题的起源与解决方案。</h3><p>php中怎么使用fsockopen实现异步请求，相信很多没有经验的人对此束手无策，为此本文总结了问题出现的原因和解决方法，通过这篇文章希望你能解决这个问题。</p>
<p>php执行一段程序，有可能几毫秒就执行完毕，也有可能耗时较长。</p>
<p>例如，用户下单这个事件，如果调用了些第三方服务进行发邮件、短信、推送等通知，可能导致前端一直在等待。</p>
<p>而有的时候，我们并不关心这些耗时脚本的返回结果，只要执行就行了。这时候就需要采用异步的方式执行。</p>
<p>众所周知，PHP没有直接支持多线程这种东西。我们可以采用折衷的方式实现。这里主要说的就是fsockopen。</p>
<p>通过fsockopen发送请求并忽略返回结果，程序可以马上返回。</p>
<p>示例代码：</p>
<pre><code>$fp = fsockopen(&quot;www.example.com&quot;, 80, $errno, $errstr, 30);
if (!$fp) {
       echo &quot;$errstr ($errno)&lt;br /&gt;\n&quot;;
} else {
       $out = &quot;GET /backend.php   HTTP/1.1\r\n&quot;;
    $out .= &quot;Host: www.example.com\r\n&quot;;
    $out .= &quot;Connection: Close\r\n\r\n&quot;;

    fwrite($fp, $out);
    /*忽略执行结果
    while (!feof($fp)) {
        echo fgets($fp, 128);
    }*/
       fclose($fp);
}
</code></pre><p>需要注意的是我们需要手动拼出header头信息。通过打开注释部分，可以查看请求返回结果，但这时候又变成同步的了，因为程序会等待返回结果才结束。</p>
<h3 id="实际测试遇到的问题"><a href="#实际测试遇到的问题" class="headerlink" title="实际测试遇到的问题"></a>实际测试遇到的问题</h3><p>实际测试的时候发现，不忽略执行结果，调试的时候每次都会成功发送sock请求；但忽略执行结果，经常看到没有成功发送sock请求。查看nginx日志，发现很多状态码为499的请求。</p>
<p>后来找到了原因：</p>
<p><code>fwrite</code>之后马上执行<code>fclose</code>，nginx会直接返回499，不会把请求转发给php处理。</p>
<p>客户端主动端口请求连接时，NGINX 不会将该请求代理给上游服务（FastCGI PHP 进程），这个时候 access log 中会以 499 记录这个请求。</p>
<h3 id="解决方案："><a href="#解决方案：" class="headerlink" title="解决方案："></a>解决方案：</h3><p>1)nginx.conf增加配置</p>
<pre><code>#忽略客户端中断
fastcgi_ignore_client_abort on;
</code></pre><p>2)fwrite之后使用usleep函数休眠20毫秒：</p>
<pre><code>usleep(20000);
</code></pre><p>后来测试就没有发现失败的情况了。</p>
<hr>
<p>相关链接：</p>
<p><a href="https://www.yisu.com/zixun/367919.html" title="参考文章1" target="_blank" rel="external">参考文章1</a></p>
<p><a href="https://blog.csdn.net/panjiapengfly/article/details/103010517" title="参考文章2" target="_blank" rel="external">参考文章2</a></p>
<p><a href="https://blog.csdn.net/wang_quan_li/article/details/41806529" title="参考文章3" target="_blank" rel="external">参考文章3</a></p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2022/05/31/online-capacity-expansion-of-cloud-disks/" itemprop="url">
                  云盘在线扩容
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2022-05-31T11:15:00+08:00" content="2022-05-31">
              2022-05-31
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/服务器/" itemprop="url" rel="index">
                    <span itemprop="name">服务器</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在线扩容，是在磁盘不够用时，直接不停机不停服的情况下扩展磁盘空间。</p>
<p>非常好用。不过，需要系统支持。</p>
<h3 id="一、扩容概述（官网说明）"><a href="#一、扩容概述（官网说明）" class="headerlink" title="一、扩容概述（官网说明）"></a>一、扩容概述（官网说明）</h3><p><a href="https://help.aliyun.com/document_detail/35095.html" target="_blank" rel="external">https://help.aliyun.com/document_detail/35095.html</a></p>
<p>这个是是前提，包括：扩容场景、系统盘扩容上限、数据盘扩容上限、扩容计费等。<br>是在进行技术操作前的一些须知与准备工作。<br>确认在用的ECS实例与云盘支持“在线扩容”之后，才能进行后续的操作。</p>
<h3 id="二、在线扩容云盘（Linux系统）（官网说明）"><a href="#二、在线扩容云盘（Linux系统）（官网说明）" class="headerlink" title="二、在线扩容云盘（Linux系统）（官网说明）"></a>二、在线扩容云盘（Linux系统）（官网说明）</h3><p><a href="https://help.aliyun.com/document_detail/113316.htm" target="_blank" rel="external">https://help.aliyun.com/document_detail/113316.htm</a></p>
<p>这个是具体的执行Linux系统的云盘“在线扩容”的详细步骤。<br>包括：前提条件，背景信息，操作步骤，支持在线扩容的操作系统，常见问题，其他扩容场景。</p>
<p>其中【操作步骤】又包括：<br>步骤一：创建快照；<br>步骤二：在控制台扩容云盘容量；<br>步骤三：查看云盘分区情况；<br>步骤四：扩容分区；<br>步骤五：扩容文件系统。</p>
<h3 id="三、实际操作步骤【关键】（实际操作）"><a href="#三、实际操作步骤【关键】（实际操作）" class="headerlink" title="三、实际操作步骤【关键】（实际操作）"></a>三、实际操作步骤【关键】（实际操作）</h3><p>1、例子：扩容/dev/vda 由80G扩容到160G</p>
<p>在阿里云上进行在线扩容操作 ：</p>
<p>存储与快照 &gt; 云盘页面选择云盘后，单击云盘扩容，选中在线扩容，并设置扩容后容量<br>Linux上执行命令</p>
<p>2、查看磁盘信息：<code>fdisk -l</code></p>
<p>3、查看要扩容的分区的文件系统类型：<code>df -hT</code></p>
<p>4、安装growpart工具<br>CentOS 7及以上版本：运行命令 <code>yum install cloud-utils-growpart</code><br>Debian 9及以上版本、Ubuntu14及以上版本：运行命令 <code>apt install -y cloud-guest-utils</code></p>
<p>5、运行命令，扩容分区：<code>growpart /dev/vda 1</code>（1前面有空格）</p>
<p>6、扩容文件系统：<code>resize2fs /dev/vda1</code> （这里1前面没有空格）</p>
<p>7、查看是否扩容成功：<code>df -hT</code></p>
<h3 id="四、几个问题的解决"><a href="#四、几个问题的解决" class="headerlink" title="四、几个问题的解决"></a>四、几个问题的解决</h3><p>1、问题出现在上述详细步骤的“4、安装growpart工具”这一步，由于CentOS8不再被支持，而造成了yum源错误的问题。</p>
<p>错误提示为：</p>
<p><code>Error:Failed to download metadata for repo &#39;AppStream&#39;</code></p>
<p>解决方案：</p>
<p>由于CentOS 8操作系统版本结束了生命周期而导致YUM源出错的问题：<br><a href="https://help.aliyun.com/document_detail/405635.htm" target="_blank" rel="external">https://help.aliyun.com/document_detail/405635.htm</a></p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2022/04/27/type-of-Apple-developer-account-and-distribution-method/" itemprop="url">
                  苹果开发者账号的类型与发布方式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2022-04-27T16:42:00+08:00" content="2022-04-27">
              2022-04-27
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/ios/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>苹果开发者账号的类型与发布方式</p>
<h2 id="开发者账号类型"><a href="#开发者账号类型" class="headerlink" title="开发者账号类型"></a>开发者账号类型</h2><p>苹果开发者账号有个人版（99美金/年），公司版（99美金/年）和企业版（299美金/年）三种。</p>
<p><strong>99美金属于标准计划；</strong></p>
<p>标准计划还分为标准个人计划和标准公司计划，区别是：如登记为标准个人计划（个人开发者），则应用程序商店中的“seller name”将显示您个人的名称，如登记为标准公司计划（公司开发者）则应用程序商店中的“seller name”将显示公司的法定名称，同时您可以把其他会员添加到开发团队。</p>
<p><strong>299美金属于企业计划。</strong></p>
<h3 id="一、99美金个人开发者账号："><a href="#一、99美金个人开发者账号：" class="headerlink" title="一、99美金个人开发者账号："></a>一、99美金个人开发者账号：</h3><p>1、开发者能够自由地创造iPhone / iPod Touch/ iPad的商业应用，并且能够发布他们的应用程序（免费或收费）在App Store上</p>
<p>2、App Store中的“seller name”将显示您个人的名称</p>
<p>3、每年可以设置100台测试机做开发及测试用</p>
<p>4、不允许开发人员创建一个团队</p>
<h3 id="二、99美金公司开发者账号："><a href="#二、99美金公司开发者账号：" class="headerlink" title="二、99美金公司开发者账号："></a>二、99美金公司开发者账号：</h3><p>1、开发者能够自由地创造iPhone / iPod Touch/ iPad的商业应用，并且能够发布他们的应用程序（免费或收费）在App Store上</p>
<p>2、App Store中的“seller name”将显示公司的法定名称</p>
<p>3、每年可以设置100台测试机做开发及测试用</p>
<p>4、允许开发人员创建一个团队，可以把其他成员添加到开发团队</p>
<p>5、公司应在邓白氏注册并拥有有效的DUNS号码</p>
<p>删除Provisioning Profiles,appid,发布证书的后果:</p>
<blockquote>
<p>如果app已经上线发布至App Store了，那么此时删除开发者账号的证书和描述文件对已经上线的app来说没什么大的影响，app可以正常使用。如果app在开发阶段，此时删除证书和描述文件，应该是不行的，上架估计都不会通过。</p>
<p>没有实际测试过</p>
</blockquote>
<h3 id="三、299美金企业开发者账号："><a href="#三、299美金企业开发者账号：" class="headerlink" title="三、299美金企业开发者账号："></a>三、299美金企业开发者账号：</h3><p>1、不允许该企业在App Store出售他们的应用程序</p>
<p>2、所开发的应用只能发给其雇员作内部使用</p>
<p>3、UDID数量不限制</p>
<p>4、允许开发人员创建一个团队，团队成员添加到他们的帐户</p>
<p>5、公司应在邓白氏注册并拥有有效的DUNS号码（面向拥有500雇员以上的公司）</p>
<p>删除Provisioning Profiles,appid,发布证书的后果:</p>
<blockquote>
<p>所有已经安装的app不能打开，会闪退，在线itms-services协议不能安装</p>
<p>所以企业应用安装到手机上则需要开发者账号上的证书和描述文件来通过手机的验证，此时删除证书和描述文件，则无法通过手机的验证，app也就无法使用了。此时下载的话则无法进行安装，会显示Unable to download app，选择Done或Retry。</p>
<p>但是我测试了删除了appid和发布证书,app没有任何影响,放在fir还是能下载安装,不知道是不是删除时间太短(删除3天了  还是能用)</p>
</blockquote>
<h2 id="发布方式（4种）："><a href="#发布方式（4种）：" class="headerlink" title="发布方式（4种）："></a>发布方式（4种）：</h2><h3 id="一、苹果应用商店发布（App-Store）"><a href="#一、苹果应用商店发布（App-Store）" class="headerlink" title="一、苹果应用商店发布（App Store）"></a>一、苹果应用商店发布（App Store）</h3><h3 id="二、苹果应用商店批量购买发布（Volume-Purchase-Program）"><a href="#二、苹果应用商店批量购买发布（Volume-Purchase-Program）" class="headerlink" title="二、苹果应用商店批量购买发布（Volume Purchase Program）"></a>二、苹果应用商店批量购买发布（Volume Purchase Program）</h3><h3 id="三、In-House企业应用发布："><a href="#三、In-House企业应用发布：" class="headerlink" title="三、In-House企业应用发布："></a>三、In-House企业应用发布：</h3><p>1、不能提交到App Store</p>
<p>2、发布应用的具体内容不需要苹果官方审核</p>
<p>3、安装设备的数量没有任何限制</p>
<p>4、把程序放在网站中，提供给最终用户一个链接，他们就能够直接下载并自动安装了</p>
<h3 id="四、Ad-Hoc应用发布方式"><a href="#四、Ad-Hoc应用发布方式" class="headerlink" title="四、Ad Hoc应用发布方式"></a>四、Ad Hoc应用发布方式</h3><p>1、不能提交到App Store</p>
<p>2、不需要经过苹果的评审，</p>
<p>3、限制每个应用不能发布到超过100个设备上</p>
<p>4、把程序放在网站中，提供给最终用户一个链接，他们就能够直接下载并自动安装了</p>
<p>（全文完）</p>
<p><a href="https://www.jianshu.com/p/87d9e4259846" target="_blank" rel="external">原文链接</a></p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2021/08/15/linux-finds-and-move-files/" itemprop="url">
                  linux查找并移动文件
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2021-08-15T11:48:00+08:00" content="2021-08-15">
              2021-08-15
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/服务器/" itemprop="url" rel="index">
                    <span itemprop="name">服务器</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>linux查找并移动文件</p>
<h3 id="原文参考"><a href="#原文参考" class="headerlink" title="原文参考"></a>原文参考</h3><pre><code>find . -name &apos;10-*.dat&apos; -exec mv {} ../ \;
</code></pre><p>这里：</p>
<p>=&gt; -exec mv {} /mnt/mp3 \; - 运行mv命令。</p>
<p>=&gt; {} - 字符 ‘{}’ 代表find到的所有内容。</p>
<p>=&gt;../表示当前用户目录的上一级目录</p>
<p>=&gt; \; - 结束 /bin/mv 命令。</p>
<h3 id="亲测可用"><a href="#亲测可用" class="headerlink" title="亲测可用"></a>亲测可用</h3><p>移动搜索匹配条件的文件到指定目录</p>
<p>查找并移动</p>
<pre><code>find . -name &apos;faverifyimage_*.png&apos; -exec mv {} ../ \;
</code></pre><p>只查找</p>
<pre><code>find . -name &apos;faverifyimage_*.png&apos;;
</code></pre><p>以下命令是：</p>
<p>移动【当前目录下（不含子目录）】【以faverifyimage_开头的图片文件】到【faverifyimgbk】目录。</p>
<p>说明：扩展了“不含子目录”这个条件，只操作“当前目录”；同时，继续执行了其他格式的图片文件。</p>
<pre><code>find . -maxdepth 1 -name &apos;faverifyimage_*.png&apos; -exec mv {} ./faverifyimgbk \;
find . -maxdepth 1 -name &apos;faverifyimage_*.jpg&apos; -exec mv {} ./faverifyimgbk \;
find . -maxdepth 1 -name &apos;faverifyimage_*.jpeg&apos; -exec mv {} ./faverifyimgbk \;
</code></pre><p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</p>
<p>之后好久没更新。</p>
<h1 id="因为github在2021年08月13日之后停止了账号密码的登录机制。"><a href="#因为github在2021年08月13日之后停止了账号密码的登录机制。" class="headerlink" title="因为github在2021年08月13日之后停止了账号密码的登录机制。"></a>因为github在2021年08月13日之后停止了账号密码的登录机制。</h1><blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>1005c8acaffa52e5d81b9fff2815f3f1febb6fdc
　　</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2021/06/07/PHP-floating-point-calculations-must-use-the-high-precision-calculation-functions-provided-by-PHP/" itemprop="url">
                  PHP浮点数计算必须使用PHP提供的高精度计算函数
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2021-06-07T10:38:00+08:00" content="2021-06-07">
              2021-06-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术日记/" itemprop="url" rel="index">
                    <span itemprop="name">技术日记</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="一、前方有坑"><a href="#一、前方有坑" class="headerlink" title="一、前方有坑"></a>一、前方有坑</h3><p>php在使用加减乘除等运算符计算浮点数的时候，经常会出现意想不到的结果，特别是关于财务数据方面的计算，给不少工程师惹了很多的麻烦。比如今天工作终于到的一个案例：</p>
<pre><code>$a = 2586;

$b = 2585.98;

var_dump($a-$b);
</code></pre><p>期望的结果是：float(0.02)</p>
<p>实际结果：</p>
<pre><code>float(0.019999999999982)
</code></pre><p>人生有坑，处处提防</p>
<h3 id="二、防坑攻略："><a href="#二、防坑攻略：" class="headerlink" title="二、防坑攻略："></a>二、防坑攻略：</h3><p>1、通过乘100的方式转化为整数加减，然后在除以100转化回来……</p>
<p>2、使用number_format转化成字符串，然后在使用（float）强转回来……</p>
<p>3、php提供了高精度计算的函数库，实际上就是为了解决这个浮点数计算问题而生的。</p>
<p>主要函数有：</p>
<p>bcadd — 将两个高精度数字相加</p>
<p>bccomp — 比较两个高精度数字，返回-1, 0, 1</p>
<p>bcdiv — 将两个高精度数字相除</p>
<p>bcmod — 求高精度数字余数</p>
<p>bcmul — 将两个高精度数字相乘</p>
<p>bcpow — 求高精度数字乘方</p>
<p>bcpowmod — 求高精度数字乘方求模，数论里非常常用</p>
<p>bcscale — 配置默认小数点位数，相当于就是Linux bc中的”scale=”</p>
<p>bcsqrt — 求高精度数字平方根</p>
<p>bcsub — 将两个高精度数字相减</p>
<p>前两种流氓的办法就不测试了，使用bcsub测试第三种两数相减的例子，</p>
<p>先看bcsub用法（来自官网）</p>
<pre><code>string bcsub ( string $left_operand , string $right_operand [, int $scale = int ] )

参数

left_operand 字符串类型的左操作数.

right_operand 字符串类型的右操作数.

scale 此可选参数用于设置结果中小数点后的小数位数。也可通过使用 bcscale() 来设置全局默认的小数位数，用于所有函数。

返回值 返回减法之后结果为字符串类型.
</code></pre><p>测试代码：</p>
<pre><code>var_dump(bcsub($a,$b,2));
</code></pre><p>结果</p>
<pre><code>0.02
</code></pre><p>其他的函数请参考PHP官方网站</p>
<h3 id="三、为啥有坑："><a href="#三、为啥有坑：" class="headerlink" title="三、为啥有坑："></a>三、为啥有坑：</h3><p>php的bug?不是，这是所有语言基本上都会遇到的问题，所以基本上大部分语言都提供了精准计算的类库或函数库。</p>
<p>要搞明白这个原因, 首先我们要知道浮点数的表示(IEEE 754):</p>
<p>浮点数, 以64位的长度(双精度)为例, 会采用1位符号位(E), 11指数位(Q), 52位尾数(M)表示(一共64位).</p>
<p>符号位：最高位表示数据的正负，0表示正数，1表示负数。</p>
<p>指数位：表示数据以2为底的幂，指数采用偏移码表示</p>
<p>尾数：表示数据小数点后的有效数字.</p>
<p>这里的关键点就在于, 小数在二进制的表示, 小数如何转化为二进制呢？</p>
<p>算法是乘以2直到没有了小数为止。这里举个例子，0.9表示成二进制数</p>
<p>0.9*2=1.8 取整数部分 1</p>
<p>0.8(1.8的小数部分)*2=1.6 取整数部分 1</p>
<p>0.6*2=1.2 取整数部分 1</p>
<p>0.2*2=0.4 取整数部分 0</p>
<p>0.4*2=0.8 取整数部分 0</p>
<p>0.8*2=1.6 取整数部分 1</p>
<p>0.6*2=1.2 取整数部分 0</p>
<p>………</p>
<p>0.9二进制表示为(从上往下): 1100100100100……</p>
<p>注意：上面的计算过程循环了，也就是说*2永远不可能消灭小数部分，这样算法将无限下去。很显然，小数的二进制表示有时是不可能精确的 。其实道理很简单，十进制系统中能不能准确表示出1/3呢？同样二进制系统也无法准确表示1/10。这也就解释了为什么浮点型减法出现了”减不尽”的精度丢失问题。</p>
<p>换句话说：我们看到十进制小数，在计算机内存储的不是一个精确的数字，也不可能精确。所以在数字加减乘除后出现意想不到的结果。</p>
<h3 id="四、防坑提示"><a href="#四、防坑提示" class="headerlink" title="四、防坑提示"></a>四、防坑提示</h3><p>基于以上原因，所以永远不要相信浮点数结果精确到了最后一位，也永远不要比较两个浮点数是否相等。如果确实需要更高的精度，应该使用任意精度数学函数或者 gmp 函数。</p>
<p>原文链接：<a href="https://www.cnblogs.com/kenshinobiy/p/10797902.html" target="_blank" rel="external">https://www.cnblogs.com/kenshinobiy/p/10797902.html</a></p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2021/04/26/two-ways-to-install-composer-on-a-linux-system/" itemprop="url">
                  Linux系统安装Composer的两种方法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2021-04-26T00:12:00+08:00" content="2021-04-26">
              2021-04-26
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术日记/" itemprop="url" rel="index">
                    <span itemprop="name">技术日记</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>实际使用的系统：CentOS 6.5</p>
<h4 id="1、方法一-CURL"><a href="#1、方法一-CURL" class="headerlink" title="1、方法一 CURL"></a>1、方法一 CURL</h4><p>下载composer.phar文件</p>
<pre><code>curl -sS https://getcomposer.org/installer | php
</code></pre><p>将composer.phar移动到环境变量中并且更名为composer</p>
<pre><code>mv composer.phar  /usr/local/bin/composer
</code></pre><p>使用国内镜像</p>
<pre><code>composer config -g repo.packagist composer https://packagist.phpcomposer.com
</code></pre><h4 id="2、方法二-直接下载composer"><a href="#2、方法二-直接下载composer" class="headerlink" title="2、方法二 直接下载composer"></a>2、方法二 直接下载composer</h4><p>下载</p>
<pre><code>wget https://getcomposer.org/composer.phar
</code></pre><p>安装</p>
<pre><code>cp composer.phar /usr/local/bin/composer
chmod u+x /usr/local/bin/composer
</code></pre><p>测试</p>
<p>composer –help</p>
<h4 id="3、安装的时候用root用户，使用的时候用非root用户"><a href="#3、安装的时候用root用户，使用的时候用非root用户" class="headerlink" title="3、安装的时候用root用户，使用的时候用非root用户"></a>3、安装的时候用root用户，使用的时候用非root用户</h4><p>否则，如果使用root运行会有提示：</p>
<p>运行composer出现<code>do not run Composer as root/super user!</code></p>
<p>解决方法：</p>
<p>第1步 创建非root的新用户</p>
<pre><code>[root@centos ~]# useradd newname
[root@centos ~]# passwd  newname
</code></pre><p>第2步 切换为新用户账户</p>
<pre><code>[root@centos ~]# su newname
</code></pre><p>切换到新用户后 , 即可执行 原来的操作 , 顺利完成 composer 指令。</p>
<p>【注意】同时，需要使用root用户将 <code>/usr/local/bin/composer</code> 设置为755，否则其他用户无法执行该命令。</p>
<p>【本人亲测，使用上述方法2和步骤3成功安装了Composer 2.1-dev版。方法1未测试。】</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2021/04/25/Server-management-blood-lessons/" itemprop="url">
                  服务器管理血的教训
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2021-04-25T05:38:00+08:00" content="2021-04-25">
              2021-04-25
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/服务器/" itemprop="url" rel="index">
                    <span itemprop="name">服务器</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>服务器管理血的教训</p>
<p>服务器管理，尤其是Linux服务器管理，必须注意以下几项原则，并做到。</p>
<h3 id="1、绝对不能随便使用rm-rf命令"><a href="#1、绝对不能随便使用rm-rf命令" class="headerlink" title="1、绝对不能随便使用rm -rf命令"></a>1、绝对不能随便使用<code>rm -rf</code>命令</h3><p>因为会递归强制删除文件，几乎都不会可恢复。【影响响程度太深】</p>
<h5 id="挽救措施："><a href="#挽救措施：" class="headerlink" title="挽救措施："></a>挽救措施：</h5><p>1、马上停止数据继续写入，将系统挂起。使用一些恢复数据的方法进行磁盘数据数据恢复操作。一般不能全部恢复；而且还会影响线上的业务的停止。</p>
<p>2、把快照的数据恢复到一个其他不是生产环境的阿里云服务器实例上，然后恢复到那个快照中的数据，再把误删除而需要的数据拷贝过来。原线上生产环境的业务不用停止。</p>
<h3 id="2、绝对不能使用-yum-update命令"><a href="#2、绝对不能使用-yum-update命令" class="headerlink" title="2、绝对不能使用 yum update命令"></a>2、绝对不能使用 <code>yum update</code>命令</h3><p>因为会升级Linux 内核，而这个升级后的内核可能会引起各种问题。【影响范围太大】</p>
<h5 id="挽救措施：-1"><a href="#挽救措施：-1" class="headerlink" title="挽救措施："></a>挽救措施：</h5><p>如果之前的系统内核还在，重启启动那个内核；<br>如果没问题的话，设置开机启动的内核为这个正常可用的内核。</p>
<h3 id="3、关键操作开始之前必须备份数据-快照"><a href="#3、关键操作开始之前必须备份数据-快照" class="headerlink" title="3、关键操作开始之前必须备份数据+快照"></a>3、关键操作开始之前必须备份数据+快照</h3><p>既不能因为精神不好产生错误的指令输入，或者粗心大意没有在意造成严重的后果；<br>又不能怕操作错误而什么都不敢做了。</p>
<p>有一个宗旨【稳定第一】【宁愿冗余，也不得丢失数据】。</p>
<p>不明确知道命令输入执行的后果的，就绝不执行。</p>
<p>——————于2021年04月25日 凌晨5：35——必须记下。</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2021/04/23/Discuz-X3.1-uses-Composer-to-install-third-party-libraries/" itemprop="url">
                  DiscuzX3.1使用Composer安装第三方类库
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2021-04-23T17:48:00+08:00" content="2021-04-23">
              2021-04-23
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术日记/" itemprop="url" rel="index">
                    <span itemprop="name">技术日记</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Discuz X3.1 是一个成熟的基于PHP开发的社区系统（广义上来讲是一个建站系统），自从被企鹅收购后悄无声息的被遗弃了，伤感啊。如今要在Discuz上加什么功能，改bug什么的只能依靠自力更生了；好在有各种开源社区，开发好的功能、类库你可以无偿的直接拿来用。</p>
<p>Composer 是一个PHP类库管理器（官网<a href="http://docs.phpcomposer.com）。Composer" target="_blank" rel="external">http://docs.phpcomposer.com）。Composer</a> 优雅的解决了PHP项目中第三方类库的安装及依赖关系。很多成熟的项目（如 Laravel ）已经把Composer作为首选的安装方式；</p>
<p>所以，在Discuz X3.1 上安装第三方类库使用Composer后，会很大提高生产力。</p>
<p>下面我来说说如何在 Discuz X3.1中使用 Composer 安装并使用第三方类库 ；</p>
<h3 id="先说安装Composer到Discuz-X3-1框架下"><a href="#先说安装Composer到Discuz-X3-1框架下" class="headerlink" title="先说安装Composer到Discuz X3.1框架下"></a>先说安装Composer到Discuz X3.1框架下</h3><h4 id="一-修改-class-core-php-source-class-class-core-php-如下"><a href="#一-修改-class-core-php-source-class-class-core-php-如下" class="headerlink" title="一. 修改 class_core.php (\source\class\class_core.php) 如下"></a>一. 修改 <code>class_core.php (\source\class\class_core.php)</code> 如下</h4><pre><code>$autoloadfile=DISCUZ_ROOT.&apos;/vendor/autoload.php&apos;;
if(!file_exists($autoloadfile)){  
    if(function_exists(&apos;spl_autoload_register&apos;)) {
        spl_autoload_register(array(&apos;core&apos;, &apos;autoload&apos;));
    } else {
           function __autoload($class) {
            return core::autoload($class);
        }
       }
}else{
    require_once  $autoloadfile;//如果存在Composer 加载器 ，则使用 ；
}
</code></pre><h4 id="二-在-Discuz-目录下，新建一个-composer-json-内容如下："><a href="#二-在-Discuz-目录下，新建一个-composer-json-内容如下：" class="headerlink" title="二. 在 Discuz 目录下，新建一个 composer.json 内容如下："></a>二. 在 Discuz 目录下，新建一个 composer.json 内容如下：</h4><pre><code>{

    &quot;require&quot;: {
         &quot;guzzlehttp/guzzle&quot;: &quot;~6.0&quot;
    },

    &quot;autoload&quot;:{
        &quot;classmap&quot;: [&quot;source/class/&quot;]
    }
}
</code></pre><h4 id="三-终端上执行命令-composer-install"><a href="#三-终端上执行命令-composer-install" class="headerlink" title="三. 终端上执行命令 composer install"></a>三. 终端上执行命令 <code>composer install</code></h4><p>看到类似这样的执行结果，表示已经安装成功了</p>
<pre><code>Loading composer repositories with package information
Updating dependencies (including require-dev)
Package operations: 10 installs, 0 updates, 0 removals
  - Installing ralouphie/getallheaders (3.0.3): Loading from cache
  - Installing psr/http-message (1.0.1): Loading from cache
  - Installing guzzlehttp/psr7 (1.8.1): Loading from cache
  - Installing guzzlehttp/promises (1.4.1): Loading from cache
  - Installing symfony/polyfill-php72 (v1.19.0): Loading from cache
  - Installing symfony/polyfill-intl-normalizer (v1.19.0): Loading from cache
  - Installing paragonie/random_compat (v2.0.20): Loading from cache
  - Installing symfony/polyfill-php70 (v1.19.0): Loading from cache
  - Installing symfony/polyfill-intl-idn (v1.19.0): Loading from cache
  - Installing guzzlehttp/guzzle (6.5.5): Loading from cache
guzzlehttp/psr7 suggests installing laminas/laminas-httphandlerrunner (Emit PSR-   7 responses)
symfony/polyfill-intl-normalizer suggests installing ext-intl (For best performa   nce)
paragonie/random_compat suggests installing ext-libsodium (Provides a modern cry   pto API that can be used to generate random bytes.)
symfony/polyfill-intl-idn suggests installing ext-intl (For best performance)
guzzlehttp/guzzle suggests installing psr/log (Required for using the Log middle   ware)
Writing lock file
Generating autoload files
4 packages you are using are looking for funding.
Use the `composer fund` command to find out more!
</code></pre><p>另外，也可以查看项目根目录下的vendor下面的文件，核验新引入的类库是否下载更新成功。</p>
<p>具体如何安装及使用 Composer 请参阅 <a href="http://docs.phpcomposer.com" target="_blank" rel="external">http://docs.phpcomposer.com</a></p>
<h3 id="再说在Discuz程序中如何使用-“composer安装”的第三方类库"><a href="#再说在Discuz程序中如何使用-“composer安装”的第三方类库" class="headerlink" title="再说在Discuz程序中如何使用 “composer安装”的第三方类库"></a>再说在Discuz程序中如何使用 “composer安装”的第三方类库</h3><p>通过Composer autoload 加载器会把这些第三方库自动加载进来，这些第三方类库程序中的类、方法(函数)等等 在Discuz 程序中你想怎么用都可以。</p>
<p>例如，以使用guzzle为例。在任何一个Discuz X3.1框架下的PHP文件中，直接使用下面代码即可。</p>
<pre><code>use GuzzleHttp\Client;

$client = new Client([
    // Base URI is used with relative requests
    &apos;base_uri&apos; =&gt; &apos;http://httpbin.org&apos;,
    // You can set any number of default request options.
    &apos;timeout&apos;  =&gt; 2.0,
]);

$response = $client-&gt;get(&apos;http://httpbin.org/get&apos;);

$code = $response-&gt;getStatusCode(); // 200
$reason = $response-&gt;getReasonPhrase(); // OK

// Check if a header exists.
if ($response-&gt;hasHeader(&apos;Content-Length&apos;)) {
    echo &quot;It exists&quot;;
}
</code></pre><p>另外，Discuz X3.2 也适用上述方法。</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2021/04/23/DiscuzX-secondary-development-directory-structure-and-operational-logic/" itemprop="url">
                  DiscuzX二次开发之目录结构和运行逻辑
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2021-04-23T03:15:00+08:00" content="2021-04-23">
              2021-04-23
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术日记/" itemprop="url" rel="index">
                    <span itemprop="name">技术日记</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-目录结构"><a href="#1-目录结构" class="headerlink" title="1.目录结构"></a>1.目录结构</h2><p>DISCUZ使用自己的框架，与现在主流的web框架不同，DISCUZ没有路由表，他的路由是由入口文件来实现的。</p>
<h3 id="api"><a href="#api" class="headerlink" title="api"></a>api</h3><ul>
<li>uc.php UCenter 通信文件</li>
<li>/api/addons 应用中心</li>
<li>/api/connect 通讯互联</li>
<li>/api/google Google引擎结构处理</li>
<li>/api/javascript 数据和广告的js调用</li>
<li>/api/manyou manyou应用及搜索等相关服务</li>
<li>/api/remote 远程更新</li>
<li>/api/trade 支付宝、财付通等交易接口</li>
</ul>
<h3 id="archiver-论坛Archiver静态化目录"><a href="#archiver-论坛Archiver静态化目录" class="headerlink" title="archiver (论坛Archiver静态化目录)"></a>archiver (论坛Archiver静态化目录)</h3><h3 id="config"><a href="#config" class="headerlink" title="config"></a>config</h3><ul>
<li>config_global.php 论坛核心参数配置文件</li>
<li>config_ucenter.php UCenter核心参数配置文件</li>
</ul>
<h3 id="data-论坛数据缓存目录"><a href="#data-论坛数据缓存目录" class="headerlink" title="data (论坛数据缓存目录)"></a>data (论坛数据缓存目录)</h3><h3 id="install-论坛安装目录-初始化运行时直接请求到此处将重新安装论坛"><a href="#install-论坛安装目录-初始化运行时直接请求到此处将重新安装论坛" class="headerlink" title="install (论坛安装目录(初始化运行时直接请求到此处将重新安装论坛))"></a>install (论坛安装目录(初始化运行时直接请求到此处将重新安装论坛))</h3><h3 id="source-程序后端功能处理目录"><a href="#source-程序后端功能处理目录" class="headerlink" title="source (程序后端功能处理目录)"></a>source (程序后端功能处理目录)</h3><ul>
<li>discuz_version.php 程序版本号文件</li>
<li>/source/admincp 后台管理</li>
<li>/source/archiver 论坛archiver静态化程序目录</li>
<li>/source/class 核心类库</li>
<li>/source/function discuzX自定义函数库</li>
<li>/source/include 程序功能组件目录</li>
<li>/source/language 程序语言包(kv结构)</li>
<li>/source/module 程序功能模块程序包</li>
<li>/source/plugins 插件扩展目录</li>
</ul>
<h3 id="static-程序资源目录-头像、图片、下载文件、js文件等等"><a href="#static-程序资源目录-头像、图片、下载文件、js文件等等" class="headerlink" title="static (程序资源目录(头像、图片、下载文件、js文件等等))"></a>static (程序资源目录(头像、图片、下载文件、js文件等等))</h3><h3 id="template-前端模板目录"><a href="#template-前端模板目录" class="headerlink" title="template (前端模板目录)"></a>template (前端模板目录)</h3><ul>
<li>/default/common 基础css文件、header、footer等公共引入文件</li>
<li>/default/collage 大学计划页面</li>
<li>/default/dige dige专区页面</li>
<li>/default/forum 首页、帖子页面</li>
<li>/default/member 会员页面</li>
<li>/default/home 家园页面</li>
<li>/default/group 群组页面</li>
<li>/default/mobile 移动端页面</li>
<li>/default/portal 文章页面</li>
<li>/default/search 搜索页面</li>
</ul>
<h3 id="uc-client-UCenter客户端"><a href="#uc-client-UCenter客户端" class="headerlink" title="uc_client (UCenter客户端)"></a>uc_client (UCenter客户端)</h3><ul>
<li>/uc_client/control UC业务处理操作类</li>
<li>/uc_client/data 缓存文件目录</li>
<li>/uc_client/lib 类库目录(包括数据库操作类,XML类,UCCODE类,邮件发送类)</li>
<li>/uc_client/model UC业务模型类</li>
</ul>
<h3 id="uc-server-UCenter服务端-后台ucenter功能实现目录"><a href="#uc-server-UCenter服务端-后台ucenter功能实现目录" class="headerlink" title="uc_server (UCenter服务端 后台ucenter功能实现目录)"></a>uc_server (UCenter服务端 后台ucenter功能实现目录)</h3><h3 id="根目录文件"><a href="#根目录文件" class="headerlink" title="根目录文件"></a>根目录文件</h3><ul>
<li>admin.php 后台入口文件</li>
<li>api.php API输出 入口文件</li>
<li>collage.php 大学计划入口文件</li>
<li>composer.json composer依赖版本记录文件</li>
<li>composer.lock composer依赖版本控制文件</li>
<li>connect.php 云平台接口文件</li>
<li>dige.php dige专区入口文件</li>
<li>forum.php 帖子信息入口文件</li>
<li>group.php 群组入口文件</li>
<li>home.php 家园入口文件</li>
<li>index.php 首页</li>
<li>member.php 用户入口文件（登录、注册、退出等）</li>
<li>misc.php 程序杂项扩展入口</li>
<li>plugin.php 插件入口文件</li>
<li>portal.php 门户入口文件</li>
<li>robots.txt 搜索引擎限制文件</li>
<li>search.php 搜索频道入口文件</li>
</ul>
<h2 id="2-运行逻辑"><a href="#2-运行逻辑" class="headerlink" title="2. 运行逻辑"></a>2. 运行逻辑</h2><p>discuz的入口文件起到了路由的作用。一个标准的discuz请求如下：</p>
<pre><code>http://localhost/home.php?mod=space&amp;uid=1&amp;do=profile
</code></pre><p>当在浏览器输入以上url时，首先执行的是跟目录下的 home.php 文件</p>
<pre><code>&lt;?php

define(&apos;APPTYPEID&apos;, 1);
define(&apos;CURSCRIPT&apos;, &apos;home&apos;);

if(!empty($_GET[&apos;mod&apos;]) &amp;&amp; ($_GET[&apos;mod&apos;] == &apos;misc&apos; || $_GET[&apos;mod&apos;] == &apos;invite&apos;)) {
    define(&apos;ALLOWGUEST&apos;, 1);
}

require_once &apos;./source/class/class_core.php&apos;;  //引入核心类文件，作用为：自动引入类规则，错误和异常处理，单例创建discuz_application类实例，引入默认函数库function.core.php
require_once &apos;./source/function/function_home.php&apos;;  //引入discuzX函数库

$discuz = C::app();  //实例化discuz_application类
$cachelist = array(&apos;magic&apos;,&apos;usergroups&apos;, &apos;diytemplatenamehome&apos;,&apos;forumlinks&apos;,&apos;identity&apos;); //加身份组缓存
$discuz-&gt;cachelist = $cachelist; //设置缓存列表
$discuz-&gt;init();  //初始化应用:数据库、系统设置、用户、session、任务、等(discuz_appication类里面)
$space = array();

$mod = getgpc(&apos;mod&apos;); //接收$_GET[&apos;mod&apos;]数据
if(!in_array($mod, array(&apos;space&apos;, &apos;spacecp&apos;, &apos;misc&apos;, &apos;magic&apos;, &apos;editor&apos;, &apos;invite&apos;, &apos;task&apos;, &apos;medal&apos;, &apos;rss&apos;, &apos;follow&apos;))) {
    $mod = &apos;space&apos;;
    $_GET[&apos;do&apos;] = &apos;home&apos;;
}

if($mod == &apos;space&apos; &amp;&amp; ((empty($_GET[&apos;do&apos;]) || $_GET[&apos;do&apos;] == &apos;index&apos;) &amp;&amp; ($_G[&apos;inajax&apos;]))) {
    $_GET[&apos;do&apos;] = &apos;profile&apos;;
}
$curmod = !empty($_G[&apos;setting&apos;][&apos;followstatus&apos;]) &amp;&amp; (empty($_GET[&apos;diy&apos;]) &amp;&amp; empty($_GET[&apos;do&apos;]) &amp;&amp; $mod == &apos;space&apos; || $_GET[&apos;do&apos;] == &apos;follow&apos;) ? &apos;follow&apos; : $mod;
define(&apos;CURMODULE&apos;, $curmod);
runhooks($_GET[&apos;do&apos;] == &apos;profile&apos; &amp;&amp; $_G[&apos;inajax&apos;] ? &apos;card&apos; : $_GET[&apos;do&apos;]);
require_once libfile(&apos;home/&apos;.$mod, &apos;module&apos;);  //根据请求时传的mod参数经由上方判断确定加载对应文件

?&gt;
</code></pre><p>注: libfile()函数在会将对应的模块字符串替换为模块的实际url。<br><code>libfile(&#39;home/&#39;.$mod, &#39;module&#39;)</code>的实际访问地址是 <code>/source/module/home/$mod.php</code></p>
<p>进入到<code>/source/module/home/home_space.php</code> 文件中 根据请求参数 uid和do的值判断具体的执行过程，有些时候会直接引入响应的程序组件完成逻辑处理(这里引入了 <code>/include/space/space_profile.php</code>)</p>
<p>在 <code>space_profile.php</code>中判断运行之后输出到模板文件<code>/template/default/home/space_profile.htm</code>中。<br>注：<code>template()</code>函数在 核心函数库 <code>function_core.php</code> 中 用于加载当前使用模板的模板文件 。根据传参此时加载了 <code>/template/default/home/space_profile.htm</code> 文件</p>
<p>在模板文件<code>space_profile.htm</code>中 可以直接使用php文件中的数据变量进行赋值渲染输出到浏览器。<br>注：template模板语法不赘述 详见 <a href="https://open.dismall.com/?ac=document&amp;page=dev_template" target="_blank" rel="external">模板语法</a></p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    

  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="isunman" />
          <p class="site-author-name" itemprop="name">isunman</p>
          <p class="site-description motion-element" itemprop="description">love IT, love Movie, love Love</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">92</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>
          
          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">42</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/isunman" target="_blank">
                  
                    <i class="fa fa-globe"></i> github
                  
                </a>
              </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
            <p class="site-author-name">Links</p>
            
              <span class="links-of-author-item">
                <a href="http://www.zhihu.com/" target="_blank">知乎</a>
              </span>
            
          
        </div>

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<div class="copyright" >
  
  &copy;  2011 - 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">isunman</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="powered-by">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>
<div class="theme-info">
<span id="busuanzi_container_site_pv">
    PV<span id="busuanzi_value_site_pv"></span> --
</span>
<span id="busuanzi_container_site_uv">
  UV<span id="busuanzi_value_site_uv"></span>
</span>
</div>


      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  


  



  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  



  



  
  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>

  
    <script type="text/javascript" src="http://cdn.staticfile.org/mathjax/2.4.0/MathJax.js"></script>
    <script type="text/javascript" src="http://cdn.staticfile.org/mathjax/2.4.0/config/TeX-AMS-MML_HTMLorMML.js"></script>
  


  
  


  

</body>
</html>
