<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Sunman，太阳侠" />





  <link rel="alternate" href="/atom.xml" title="太阳侠" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description" content="love IT, love Movie, love Love">
<meta property="og:type" content="website">
<meta property="og:title" content="太阳侠">
<meta property="og:url" content="http://isunman.com/index.html">
<meta property="og:site_name" content="太阳侠">
<meta property="og:description" content="love IT, love Movie, love Love">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="太阳侠">
<meta name="twitter:description" content="love IT, love Movie, love Love">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: undefined,
      author: '博主'
    }
  };
</script>

  <title> 太阳侠 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?edc09d74f003ef7b14a37137efc44fd4";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>






  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">太阳侠</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">我是一颗恒星</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      

      
      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">

    

    
    

    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/06/11/issue-of-ca-root-certificate-expiration/" itemprop="url">
                  CA根证书过期的问题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2020-06-11T15:38:00+08:00" content="2020-06-11">
              2020-06-11
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术日记/" itemprop="url" rel="index">
                    <span itemprop="name">技术日记</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>上一篇文章提到过PHP的curl函数的证书错误</p>
<pre><code>Peer certificate cannot be authenticated with known CA certificates
</code></pre><p>中文的意思“对等证书不能使用已知的CA证书进行身份验证”。</p>
<p>后来采用了在curl函数中不验证证书的临时解决方法。</p>
<p>虽然问题暂时解决了，但是并没有找到出问题的根本原因，当然也就没有从根本上解决问题。</p>
<h4 id="紧接着，后续又出大问题了。"><a href="#紧接着，后续又出大问题了。" class="headerlink" title="紧接着，后续又出大问题了。"></a>紧接着，后续又出大问题了。</h4><p>在linux服务器上的crontab中设置的计划任务也不执行了。里面都是使用的wget加https的URL执行的。<br>经核查发现：</p>
<p>1、crontab的计划任务是在定期执行的，只是没有执行wget+https的URL请求。</p>
<p>2、上述计划任务中https的URL请求，如果在浏览器执行或postman中执行，都是可以正常执行出结果的。</p>
<p>所以证明是wget在执行https的请求时出问题了。</p>
<p>联系亚狐科技的客服，询问他们的SSL证书是不是出问题了。</p>
<p>回复是，SSL证书本身没有过期，但是颁发SSL证书的CA机构的【根证书】过期了。</p>
<p>回复原话</p>
<blockquote>
<p>是CA证书过期了, 您更新下CA证书即可。证书没问题，有问题的是COMODO的上级证书链。浏览器访问都没问题。我可以发您最新的根证书，您替换旧可以。4月30日后签发的证书就没这个问题了。这个问题是历史问题，没办法避免。这样，我全部更新下，您重新下载可以吧。这个我们会注意这个问题，如果再有类似，我通知您。应该不会再发生了。一般如果只是使用浏览器，不会存在问题。是的，我们接收意见，以后避免再发生此类问题。</p>
</blockquote>
<p>当然中间有我的提问没有写出来，这是QQ聊天记录的对方回复的部分内容的合并。</p>
<p>之后重新颁发了新的SSL证书，然后更新到所有使用该SSL证书的Nginx服务器之后（重启Nginx），crontab的计划任务可以正常执行了。</p>
<h4 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h4><p>1、CA的根证书快过期本应该提前处理好的，这个根证书时间应该不是每一年一次的。5年或10年吧，还不确定。</p>
<p>2、这个CA根证书过期导致的是一些程序的执行命令和系统方法出问题，在浏览器中使用并不会表现出BUG和错误。（目前已发现明显会受影响的就是PHP的CURL函数和Linux的crontab中的wget命令）</p>
<p>3、当一个问题出现时，必须及时准确地定位到问题的真正和根本原因，并迅速彻底解决；否则，可能会出现更严重的问题。</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/06/01/peer-certificate-of-php-curl-function-cannot-be-authenticated/" itemprop="url">
                  PHP的curl函数的证书错误 Peer certificate cannot be authenticated
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2020-06-01T17:14:00+08:00" content="2020-06-01">
              2020-06-01
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术日记/" itemprop="url" rel="index">
                    <span itemprop="name">技术日记</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>系统的短信发送突然全部失败了。使用postman工具测试阿里云云通信的短信API可以正常发送。</p>
<p>经过一番仔细核查，原因已找到，是PHP系统自带的CURL函数中的证书验证问题。</p>
<p>错误提示：</p>
<pre><code>Peer certificate cannot be authenticated with known CA certificates
</code></pre><p>中文的意思“对等证书不能使用已知的CA证书进行身份验证”。</p>
<p>解决方案：<br>curl的设置中加入这样一项</p>
<pre><code>curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
</code></pre><p>即在请求中“信任任何证书”，不再进行CA证书验证。</p>
<p>但是至少耽误了一天半的短信发送，只是因为周末和月底，没被发现而已。从2020年05月30日 19:36之后到2020年06月01日10:30之前，都是失败的。</p>
<p><strong>奇怪的就是</strong>：为什么之前可以用，突然在2020年05月30日晚上失败了，而且是在没有更改任何服务器配置和项目相关代码的情况。后来检测，其他项目中使用相同方法的也失败了。不得不逐一修复。</p>
<p>关于CURL函数可以参考官网说明<br><a href="https://www.php.net/manual/en/function.curl-setopt.php" target="_blank" rel="external">https://www.php.net/manual/en/function.curl-setopt.php</a></p>
<p>以下为php curl https ssl 证书相关的设置汇总：</p>
<pre><code>$curl = curl_init();
curl_setopt($curl,CURLOPT_URL,$url);
curl_setopt($curl, CURLOPT_PORT, 443);
curl_setopt($curl, CURLOPT_SSLVERSION, 3);
curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false); //信任任何证书
curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, 0); // 检查证书中是否设置域名,0不验证
curl_setopt($curl, CURLOPT_VERBOSE, 1); //debug模式
curl_setopt($curl, CURLOPT_SSLCERT, &quot;./keys/client.crt&quot;); //client.crt文件路径
curl_setopt($curl, CURLOPT_SSLCERTPASSWD, &quot;112358&quot;); //client证书密码
curl_setopt($curl, CURLOPT_SSLKEY, &quot;./keys/client.key&quot;);
curl_setopt($curl, CURLOPT_POST, 1);
curl_setopt($curl, CURLOPT_POSTFIELDS, $data);
</code></pre><hr>
<p>所以，在最后总结三点：</p>
<p>1、怎么能及时地发现问题；（有没有报警机制）</p>
<p>2、怎么能快速地解决问题；（核查问题的能力）</p>
<p>3、怎么能避免问题不再发生。（预防可能遇到的坑）
　　</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/05/10/linux-system-inodes-resource-depletion-problem/" itemprop="url">
                  Linux系统inodes资源耗尽问题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2020-05-10T18:33:00+08:00" content="2020-05-10">
              2020-05-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/服务器/" itemprop="url" rel="index">
                    <span itemprop="name">服务器</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Linux系统inodes资源耗尽问题</p>
<h3 id="1-inodes介绍"><a href="#1-inodes介绍" class="headerlink" title="1 inodes介绍"></a>1 inodes介绍</h3><p>Linux系统下文件数据储存在”块”中，文件的元信息，例如文件的创建者、文件的创建日期、文件的大小等。这种储存文件元信息的区域就叫做inode，中文译名为”索引节点”。</p>
<p>inode也占用硬盘空间，硬盘格式化的时候，操作系统自动将硬盘分成两个区域。一个是数据区，存放文件数据；另一个是inode区（inode table），存放inode所包含的信息。</p>
<p>每个inode节点的大小，一般是128字节或256字节。inode节点的总数，在格式化时就给定，一般是每1KB或每2KB就设置一个inode。假定在一块1GB的硬盘中，每个inode节点的大小为128字节，每1KB就设置一个inode，那么inode table的大小就会达到128MB，占整块硬盘的12.8%。</p>
<h3 id="2-inodes资源耗尽"><a href="#2-inodes资源耗尽" class="headerlink" title="2 inodes资源耗尽"></a>2 inodes资源耗尽</h3><p>inodes使用完与存储空间使用完相似，都是创建不了文件或无法正常执行一些命令。inodes使用完，存储空间可能还有，这种情况一般是生成了大量的小文件，把inode table占满。</p>
<p>一般情况下存储空间使用完，inodes往往才使用百分之几，所以容易忽视对inodes使用情况的监控。</p>
<p>借用网图来说明inodes用尽，而磁盘空间还未用完的情况：</p>
<p>查看磁盘空间使用情况，使用df命令</p>
<p>查看inodess使用情况，使用df -i命令</p>
<p>上述两个命令可以使用-h参数，命令为df -h和df -hi。从图中看见磁盘空间使用71%，但是inodes使用100%。</p>
<h3 id="3-inodes耗尽解决"><a href="#3-inodes耗尽解决" class="headerlink" title="3 inodes耗尽解决"></a>3 inodes耗尽解决</h3><p>inodes的大小在磁盘格式化分区时确定，跟分区的大小相关，分区越大，inodes越大，反之亦然。</p>
<p>linux操作系统根目录一般分区比较小，如果有定时性的小文件产生而又未及时清理，则很容易造成inodes占满。</p>
<p>inodes占满解决步骤：</p>
<h4 id="（1）查看文件最多的目录"><a href="#（1）查看文件最多的目录" class="headerlink" title="（1）查看文件最多的目录"></a>（1）查看文件最多的目录</h4><pre><code>for i in /*; do echo $i; find $i | wc -l; done
</code></pre><p>如果确定目录范围，把/*写的具体点</p>
<p>最终发现是/var/spool/postfix/maildrop目录下小文件过多，原因如下：</p>
<p>由于linux在执行cron时，会将cron执行脚本中的output和warning信息，都会以邮件的形式发送给cron所有者。由于客户环境中的sendmail和postfix没有正常运行，邮件发送不成功，导致全部小文件都堆积在maildrop目录下，另由于缺乏自动清理的机制，故此目录下堆积了大量的文件。</p>
<p>经过排查root用户下发现有个每分钟进行一次时钟同步的定时任务，该定时任务每分钟产生一个小文件。</p>
<h4 id="（2）删除大量文件"><a href="#（2）删除大量文件" class="headerlink" title="（2）删除大量文件"></a>（2）删除大量文件</h4><pre><code>ls | xargs -n 1000 rm -rf
</code></pre><p><strong>需要使用xargs命令，不然会删除失败。</strong></p>
<h3 id="4-总结"><a href="#4-总结" class="headerlink" title="4 总结"></a>4 总结</h3><h4 id="（1）设置方面"><a href="#（1）设置方面" class="headerlink" title="（1）设置方面"></a>（1）设置方面</h4><p>在crontab -e 第一行增加MAILTO=”” ，就没有文件产生啦</p>
<h4 id="（2）重定向"><a href="#（2）重定向" class="headerlink" title="（2）重定向"></a>（2）重定向</h4><p>对定时任务设置定向输出文件，不需要日志输出的定时任务可以将日志重定向到/dev/null，如下：</p>
<pre><code>*/10 * * * * /tmp/test.sh &gt;/dev/null 2&gt;&amp;1
</code></pre><h4 id="（3）定时清理文件"><a href="#（3）定时清理文件" class="headerlink" title="（3）定时清理文件"></a>（3）定时清理文件</h4><pre><code>find 目录 -type f -mtime +30 | xargs -n 1000 rm -f
</code></pre><h4 id="（4）监控inodes的使用"><a href="#（4）监控inodes的使用" class="headerlink" title="（4）监控inodes的使用"></a>（4）监控inodes的使用</h4><p>备注：应注意crontab的写法和产生的文件的定时清理</p>
<hr>
<p>以下来自另一篇文章《查找和删除占用较多Inodes的目录》</p>
<p>1.df -h 显示磁盘使用未到52%，但 df -i 显示 100%，站点程序提示</p>
<pre><code>Warning: session_start(): open(/tmp/sess_24q39g3sh8viclu4ok8nkl7nt7, O_RDWR) failed: No space left on device
</code></pre><p>2.先尝试删除/tmp目录的一个或多个临时文件</p>
<p>3.从少到多，显示目录占用的inodes数量【实测此条实用】</p>
<pre><code>find / -xdev -printf &apos;%h\n&apos; | sort | uniq -c | sort -k 1 -n
</code></pre><p>4.本例是 /var/spool/clientmqueue/ 目录占用的inodes数量最多</p>
<p>5.转到相应的目录，且删除该目录下的文件，请谨慎操作</p>
<pre><code>cd /var/spool/clientmqueue &amp;&amp; ls | xargs rm -f
</code></pre><p>6.再次查看inodes占用情况，降到10%了</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/05/10/the-nginx-accesslog-file-is-too-large-to-clean-up/" itemprop="url">
                  Nginx access.log文件太大，自动释放清理
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2020-05-10T18:30:00+08:00" content="2020-05-10">
              2020-05-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/服务器/" itemprop="url" rel="index">
                    <span itemprop="name">服务器</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Nginx access.log文件太大，自动释放清理</p>
<p>Nginx在涉及大流量时，会发生非常庞大的日志文件，包含access.log和error.log，日志会随着连接不断增加，到无限大。如果日志文件太大，会导致Nginx运行缓慢，卡顿，也是存储资源的浪费。</p>
<p>该文件为nginx的访问日志文件可以删除,删除后nginx启动还会产生<br>如果要关闭日志功能,在nginx配置文件中找到access_log一行,改为access_log off;</p>
<h3 id="手动释放清理Nginx日志文件access-log"><a href="#手动释放清理Nginx日志文件access-log" class="headerlink" title="手动释放清理Nginx日志文件access.log"></a>手动释放清理Nginx日志文件access.log</h3><p>查看并查找相关信息及路径</p>
<pre><code># 查看空间占用
$ df -h

# 定位Nginx
$ which nginx
/usr/local/nginx/logs

# 列出日志文件
$ cd /usr/local/nginx/logs
ls

# 查看日志文件大小
$ du -sh ./*

# 暂停Nginx并删除日志文件
# nginx -s stop
rm -rf *.log
</code></pre><p>这里需要注意的是，看到网上有人说重启Nginx可以清除日志文件，这是错误的。重启并不会清空日志文件，你需要手动清理。</p>
<p>另外，你也可以使用覆盖日志的方法清理Nginx日志文件</p>
<pre><code>echo &quot;&quot; &gt; /usr/local/nginx/access.log
</code></pre><p>如果不需要日志文件就直接关闭（不建议），nginx.conf</p>
<pre><code>access_log off; 
</code></pre><h3 id="对Nginx-access-log进行分割"><a href="#对Nginx-access-log进行分割" class="headerlink" title="对Nginx access.log进行分割"></a>对Nginx access.log进行分割</h3><p>通过shell脚本+linux的定时任务进行的一个平滑切分。不需要重启nginx进程。代码cut_logs.sh</p>
<pre><code>#!/bin/bash
log_path=/usr/local/nginx/logs/access.log
save_path=/usr/local/nginx/logs/bak/access_$(date +%Y%m%d -d &apos;yesterday&apos;).log
cp $log_path $save_path &amp;&amp; echo &gt; $log_path
</code></pre><p>设置定时任务</p>
<pre><code>$ crontab -e
#输入
0 0  * * * /usr/bin/sh cut_logs.sh #每天的00:00执行日志切分

$ crontab -l #查看定时任务是否添加成功
</code></pre>
          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/03/25/liang-ning-speech-practice-in-the-product/" itemprop="url">
                  梁宁演讲：在产品里修行
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2020-03-25T13:39:00+08:00" content="2020-03-25">
              2020-03-25
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/生活感悟/" itemprop="url" rel="index">
                    <span itemprop="name">生活感悟</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>梁宁演讲：在产品里修行</p>
<p>大家好，我是梁宁，今天我演讲的题目叫做《在产品里修行》。</p>
<p><strong>做一个产品就是你的修行，因为在这个过程里，你需要认识这个世界，你需要认识人的弱点。你需要认识你的本性，并且不去挑战它。你需要认识你的合作伙伴的本性，并且知道怎么去做跨文化的交流。</strong></p>
<p>##你需要洞察人性并且不去挑战它</p>
<p><strong>做产品和做运营是两种人格</strong></p>
<p>我们在讨论这次课程的时候，说到一个现象：为什么现在优秀的产品经理里面女性很少?</p>
<p>一个很重要的原因就是大多数女性是容忍度非常高的人。容忍度高的人，其实是做不了好产品的。她很难把别人逼到角落里还要坚持自己主张。</p>
<p>产品经理最重要的是有创造力。而创造力是自我的延伸，所以创造力强的人都是极端以自我为中心的人，很难照顾别人的感受。</p>
<p><strong>他的自我造就了他对产品的敏感和决不妥协的态度，以及推到一切的创造力。所以我们看到乔布斯其实就是一个绝对自我的人。</strong></p>
<p>腾讯里面关于产品还有另外一个岗位，叫做运营经理。运营经理最重要的是控制，控制节奏，控制资源，控制结果。控制其实是自制力的延伸。</p>
<p><strong>你会发现，作为一个人类，你不可能同时具备超强的自我和超强的自制。所以你如果是一个非常好的营销人员，一定不是一个好产品经理，因为他太爱迎合别人，太懂得体贴别人的人。</strong></p>
<p>##最大的成本就是用错人</p>
<p>作为一个创业的公司，很重要的一件事就是，你需要和优秀的人建立重度关系，你不能把时间都放在不优秀的人身上。</p>
<p>如何去发现优秀的人?他们有三个特点，第一个是敏感度高，第二个特点是容忍度低，第三个特点是主动优化。</p>
<p>1，<strong>敏感度高</strong>，其实和每个人的天分有关。有的人一眼就看出有问题，而有的人却很难觉察。这个在面试的时候就应该果断判断，因为让一个人做他不擅长的事情，只能带来双方的痛苦和时间浪费。</p>
<p>2，<strong>容忍度低</strong>，从某种程度上来件，其实是一种文化的塑造。比如我们的父母，他们都是在一个完全集体主义的环境中成长起来的，所以他们的成长环境决定了他们势必要学会妥协、容忍，差不多就行了。中国制造、中国产品的特征，同样也是这种高容忍度的产物。</p>
<p>3，<strong>主动优化</strong>。一个人发现了问题，他是在不停抱怨还是主动优化?这个取决于你和他的沟通和鼓励。</p>
<p>比如我家很乱，我请了一个阿姨来打扫，但是她第一次来，她肯定得不停地和我沟通，哪些可以扔哪些不能动。但是时间长了以后，你不用多说，她也可以自动优化了。</p>
<p><strong>所以我们在搭建团队的时候，首先就是你必须快速地察觉他是不是有足够的敏感度，其次，用你的沟通和鼓励让他从一个敏感，容忍度低的人变成一个能够主动优化的人，这是我们搭建一个好的创业团队的关键。</strong></p>
<p>##你对世界的洞察在你的产品之中</p>
<p>你对于世界的洞察，对于产业的掌控力，其实都在你自己的产品当中。接下来我们说一说对产品的洞察。</p>
<p>我想分为产品、用户、场景三点来分析。</p>
<p>你要提供的产品，是你能够持续驾驭的产业链的长度、力度和精准度。</p>
<h2 id="产品是你提供服务的能力"><a href="#产品是你提供服务的能力" class="headerlink" title="产品是你提供服务的能力"></a>产品是你提供服务的能力</h2><p>先看产品。<strong>产品不是简单的APP界面，而是你提供服务的能力。</strong></p>
<p>我之前做过一个旅游网站，后来被腾讯全资收购，于是有了在腾讯学习工作的三年。在腾讯的内部交流里，没有人谈产品和功能，大家谈的是服务和特性。</p>
<p>为什么?因为你在谈产品，有可能一个功能扩展起来就是一个产品，比如说评论，对于很多人来讲是一个功能，但是你把它整个运营好，它就是微博。</p>
<p>所以不谈产品，谈服务，我们关心你提供的到底是一个什么样的服务?</p>
<p>这种思路就解决了不是以产品经理的个人认知为中心，而是以服务对象的需求和满意度为中心去优化产品、设计服务的问题。</p>
<h3 id="真正关键的是产品的隐性特征"><a href="#真正关键的是产品的隐性特征" class="headerlink" title="真正关键的是产品的隐性特征"></a>真正关键的是产品的隐性特征</h3><p>我在腾讯学会的第一节产品课是一台ATM机。</p>
<p>第一个问题，ATM机提供什么服务?取现。第二个问题，ATM机有什么特性?</p>
<p>一堆的产品控可能跳出来说：屏幕是什么颜色的?是先出卡还是先出钞?能否支持手机扫码取现?</p>
<p>其实这些都是ATM机的显性特征。那么ATM机的隐性特征是什么?</p>
<p>大家知道在一台ATM机里面会放现金?一台ATM机基本四个钞箱，一个钞箱是20万现金，四个都装满了是80万。但大多数ATM机会放50万现金在里面。为什么?因为这些放在ATM机的现金是不能产生利息的。</p>
<p>也就是说，当ATM提供为柜台分流取现压力的同时，它同时也分流了这个企业的核心资源。</p>
<p>所以如何通过数据统计支持决策，既能为用户提供充足的取现服务，又能避免过多的资金闲置，成为ATM机的隐性特征。</p>
<p>第三个问题，ATM服务的全流程是什么?</p>
<p>表面上来看，用户只需要插卡、输入密码，就可以取现。但是从企业角度来看，它至少需要这些流程去支持一台ATM机的正常运转。</p>
<p>战略部门。它来确定我们为什么需要一台ATM机。</p>
<p>战略价值分两个：分流柜台窗口的取现压力;在人流多的商场设置ATM机，可以向用户传达品牌亲近感和安心感。</p>
<p>运营部。用数据分析支持决策：在哪些网点设置ATM机以及放置多少现金。</p>
<p>运营部四个功能：第一个增撤网点;第二个现金管理，包括现金的回收和放置;此外还需要两个人，一个人管硬件，一个人拿钥匙。</p>
<p>硬件维护。ATM机的无法打印凭条，断电等等问题的处理。</p>
<p>客服。取钱吞卡，出钱有误等等问题处理。</p>
<p>就是说这么一台最简单的产品，它的背后需要至少7个岗位来围绕它工作。</p>
<p>###结论</p>
<p>当我们谈起产品，绝大多数人想到的只是APP的界面，但实际上对产品的定义是完整的服务流程，和总体的服务成本。你要提供的产品，是你能够持续驾驭的产业链的长度、力度和精准度。</p>
<p>什么叫长度?京东的供应链和物流控制能力。</p>
<p>什么叫力度?比如双十一大战时，天猫向供应商要求，你只能向我供货，我是你的唯一分销商。这就是力度。</p>
<p>什么是精准度?我重仓压一个什么东西，结果搞错了，这就是精准度的问题。首先去搞清楚，自己要提供的到底是什么服务?</p>
<p>最后再去想怎么展现，是用APP还是网站还是实体店，这些都只是产品的显性特征和外化模式而已。</p>
<p>不管是小闲还是笨笨，最后都会转化为笨笨，这里面是一个情绪触发的过程。</p>
<p>好的产品从精细的用户画像开始</p>
<h2 id="第二个，用户。"><a href="#第二个，用户。" class="headerlink" title="第二个，用户。"></a>第二个，用户。</h2><p>刚刚我们举的一台ATM机的例子，我们说它是最简答的产品。为什么，因为它是唯一一个不用考虑用户细分的产品。</p>
<p>但是除了钱之外的任何一个产品，你都需要做用户细分，去研究用户画像。所以大家记住，我们做的东西是一定是远比一台ATM机复杂的产品。</p>
<p>###三类最简单的用户画像</p>
<p>关于用户画像，我们从最简单的三个用户说起：</p>
<p>第一个用户叫“大明“。大明的特点是什么呢?他决定暑假的某一段确定的时间带小孩去新加坡旅游。他要做什么，什么时间做，他非常清楚。</p>
<p>他对自己所要的东西已经非常清晰了，所以给我硬货，好的配置和好的价格，最快的效率，这就是大明需要的。</p>
<p>中国最早的电子商务网站，都是服务于大明的。这些网站的共同特点就是大大的搜索框，强大的检索功能，非常快地找到自己要的东西，这对大明来说，就是最好的服务。</p>
<p>还有一类叫“笨笨”。笨笨什么特点呢?暑假我想出去玩，但是去哪儿呢?欧洲没去过，巴厘岛也没去过，听说新加坡也挺好的，好多人都去日本…然后我去哪儿玩呢，有可能她最后去了漓江，或者她哪儿也没去，就在北京怀柔延庆溜达了一下。</p>
<p>笨笨的特点就是不知道自己要什么。你给我搜索框，可是我还不知道自己要什么?我需要浏览，我需要逛，可能我花了8个小时逛街，本来要买的裙子没有买，而是买了一把雨伞和几双袜子。</p>
<p>所以互联网崛起的第二类电商其实是服务于笨笨的。蘑菇街，小红书都是这样的模式，给你充分的浏览，在你的浏览过程中，设计促进购物决策的环节。</p>
<p>还有一类叫“小闲”。我没有想去旅游，我就是无聊来网上瞎逛。小闲其实就是你我的常态，就是我们的需求没有被触发之前，其实人人都是小闲。</p>
<p>其实腾讯是一个非常经典的服务小闲的公司，为什么呢?QQ聊天是因为闲，刷微信朋友圈也是因为闲，你在任何一个闲的时候，你只要打开腾讯的产品，都可以足够让你打发时间。</p>
<p>所以从腾讯的小闲延伸出来，到游戏和视频的转化率就非常高，为什么?因为游戏也好、视频也好，它本质上都是沿着小闲的行为路径，让大家继续打发时间的一个行动。</p>
<p>这是三种用户的不同的状态。</p>
<p>不管是“小闲”还是“笨笨”</p>
<p>最后都会变成“大明”</p>
<p>从小闲到笨笨到大明，其实这是一个连续的情绪触发的过程。怎么解释，其实当用户的情绪被触发，锁定了他要做什么事情的时候，小闲和笨笨就变成了大明。</p>
<p>你要服务小闲，你就需要提供一个打发时间的东西，豆瓣、天涯、猫扑、这些社区网站就是这类产品。但是我们看到这类产品向交易导流的效果都不太好，其实就是因为从小闲到大明的转化流程过长。</p>
<p>笨笨的产品就很典型，比如说美丽说，蘑菇街，我先收藏，收藏了很多以后，我到淘宝上去搜同类，搜到最喜欢的款式以后，我再去比价，找到最便宜的那家，然后购买。</p>
<p>上面就是一个比较经典的用户从小闲到笨笨到大明的转化过程，其实我们每个人都会有一个情绪被激发和需求变明确的过程。</p>
<p>但是不管这个用户之前是小闲还是笨笨，是男是女，最后购买的一瞬间一定是变成大明。而搞定大明的唯一的办法就是提供硬货。</p>
<p><strong>场景是通过情绪触发和意见挟裹引导用户决策的过程。</strong></p>
<p>场景是引导用户决策的过程</p>
<p>##第三个是场景。</p>
<p>从小闲到笨笨再到大明这个过程中，其实有非常多的具体和建设场景的工作要做。</p>
<p>场景是什么?“场”是停留时间和消费时间，而“景”是情绪触发和意见挟裹。</p>
<p>如果你只提供了一个广告，但是你没有给用户提供停留空间，然后在这个停留时间里面去激发用户的消费情绪，那么这个广告转化成购买的距离还是非常遥远。</p>
<p>情绪是最支持人做决策的一个动力。下一件事情是互动，那互动的本质其实是你对用户行为的影响。</p>
<p>营销活动就是这么一个场景，让用户停留在我搭建的场景里，花时间了解，酝酿情绪，然后他被周围的意见挟裹，被你引导，这就是营销的核心。它的核心不在于你提供一个功能，而在于你搭建了一个场景。</p>
<p>举个例子，罗辑思维</p>
<p>罗辑思维有一次打包卖书，就是这个套装里面有6本书，但是你不知道你们都有哪些书，而且限量8000套来销售。</p>
<p>一个淘宝店主就觉得这个套装一定有价值，因为限量必须要抢购。所以他在开卖的第一时间就抢购了10套，在紧接着的1个小时内8000套书就售罄了。</p>
<p>罗辑思维的群里还有人在问，怎么没了，还能到哪儿买?于是这位淘宝店主就把他买的10套书上架销售。</p>
<p>他就想说，大家都想买买不到，我怎么着也得加点价吧。于是他加了点价450开卖，放了两天没人来问，降到400，还是没人问，然后打折，还是没有人问。最后这套书在淘宝是零交易。</p>
<p>为什么同样一套书，在罗辑思维上是1小时8000套一抢而空，但是在淘宝店主这里是打了对折，放了10天还是零交易呢?</p>
<p>原因就在于罗辑思维其实搭建了一个场景，对消费者进行意见挟裹。这里面最核心的是什么?如果你架构的场景，不能影响别人的情绪，不能对别人造成情绪触动的，那它就不是一个场景。</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/02/15/mobile-phone-app-scan-code-login-web-terminal-how-to-achieve-technically/" itemprop="url">
                  手机App扫码登录Web端，技术上是怎么实现的？
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2020-02-15T11:38:00+08:00" content="2020-02-15">
              2020-02-15
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术日记/" itemprop="url" rel="index">
                    <span itemprop="name">技术日记</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>手机App扫码登录Web端，技术上是怎么实现的？</p>
<p>##1、引言</p>
<p>扫码登录这个功能，最早应该是微信的PC端开始搞，虽然有点反人类的功能（不扫码也没别的方式登录），但不得不说还是很酷的。</p>
<p>下面这张图，不管是IM开发者还是普通用户，应该很熟悉：</p>
<p><img src="http://www.52im.net/data/attachment/forum/202001/06/202655hhi73ezfei7icd88.jpg" alt=""></p>
<p>于是，搞IM产品的老板和产品经理们，从此又多了一个要抛给程序员们的需求——“为什么微信有扫一扫登录，而我们的没有？”。</p>
<p>好吧，每次只要是微信有的功能，IM程序员们想甩锅，难度就有点大了，毕竟老板们都都会想当然认为，微信有的“我”的IM产品里也得有。</p>
<p>既然无法回避，那就只能老老实实搞懂技术原理，然后自已使劲撸吧。</p>
<p>本文将简要的介绍扫码登录功能的技术实现逻辑，并实际结合淘宝、微信的扫码登录功能，学习和研究大厂主流应用的技术实现思路。</p>
<p>##2、基本技术原理</p>
<p>###2.1 扫码登录功能到底是什么样的？</p>
<p>首先介绍下什么是扫码登录。现在大部分同学手机上都装有微信、qq和淘宝这一类的软件。而这些app都有他们相对应的网页端。为了让用户在使用他们的网页时登录更加方便和安全，使用手机扫一扫就可以登录的服务，就显得自然而然了。</p>
<p>几个主流大厂应用扫码登录时的界面效果如下：</p>
<p><img src="http://www.52im.net/data/attachment/forum/202001/06/203056dycwfmmpcpoh6m8e.jpg" alt=""></p>
<p>有很多小伙伴可能会感到很神奇，网页上只是显示了个二维码，它怎么就知道是哪个手机扫到了二维码，并且进行登录的呢？而且，登录完成以后，还能直接把用户信息显示给用户，真的是很神奇啊。</p>
<p>###2.2 扫码登录功能的完整技术逻辑</p>
<p>####1）网页端与服务器的配合逻辑：</p>
<p>接下来就是对于这个服务的详细实现。</p>
<p>首先用户打开网站的登录页面的时候，向浏览器的服务器发送获取登录二维码的请求。服务器收到请求后，随机生成一个uuid，将这个id作为key值存入redis服务器，同时设置一个过期时间，再过期后，用户登录二维码需要进行刷新重新获取。</p>
<p>同时，将这个key值和本公司的验证字符串合在一起，通过二维码生成接口，生成一个二维码的图片（二维码生成，网上有很多现成的接口和源码，这里不再介绍）。然后，将二维码图片和uuid一起返回给用户浏览器。</p>
<p>浏览器拿到二维码和uuid后，会每隔一秒向浏览器发送一次，登录是否成功的请求。请求中携带有uuid作为当前页面的标识符。这里有的同学就会奇怪了，服务器只存了个uuid在redis中作为key值，怎么会有用户的id信息呢？</p>
<p>这里确实会有用户的id信息，这个id信息是由手机服务器存入redis中的。具体请继续阅读“手机端与服务器的配合逻辑”。</p>
<p>####2）手机端与服务器的配合逻辑：</p>
<p>话说，浏览器拿到二维码后，将二维码展示到网页上，并给用户一个提示：请掏出您的手机，打开扫一扫进行登录。</p>
<p>用户拿出手机扫描二维码，就可以得到一个验证信息和一个uuid（扫描二维码获取字符串的功能在网上同样有很多demo，这里就不详细介绍了）。</p>
<p>由于手机端已经进行过了登录，在访问手机端的服务器的时候，参数中都会携带一个用户的token，手机端服务器可以从中解析到用户的userId（这里从token中取值而不是手机端直接传userid是为了安全，直接传userid可能会被截获和修改，token是加密的，被修改的风险会小很多）。手机端将解析到的数据和用户token一起作为参数，向服务器发送验证登录请求（这里的服务器是手机服务器，手机端的服务器跟网页端服务器不是同一台服务器）。</p>
<p>服务器收到请求后，首先对比参数中的验证信息，确定是否为用户登录请求接口。如果是，返回一个确认信息给手机端。</p>
<p>手机端收到返回后，将登录确认框显示给用户（防止用户误操作，同时使登录更加人性化）。用户确认是进行的登录操作后，手机再次发送请求。服务器拿到uuId和userId后，将用户的userid作为value值存入redis中以uuid作为key的键值对中。</p>
<p>####3）登录成功时的逻辑：</p>
<p>然后，浏览器再次发送请求的时候，浏览器端的服务器就可以得到一个用户Id，并调用登录的方法，生成一个浏览器端的token，再浏览器再次发送请求的时候，将用户信息返回给浏览器，登录成功。这里存储用户id而不是直接存储用户信息是因为，手机端的用户信息，不一定是和浏览器端的用户信息完全一致。</p>
<p>####4）详细的技术原理总结如下图所示：</p>
<p><img src="http://www.52im.net/data/attachment/forum/202001/06/210751e2bz7c27qcbq7ugo.png" alt=""></p>
<p>###3、淘宝的扫码登录技术实现</p>
<p>本节我们以淘宝的扫码登录为例，来实际研究分析一下淘宝的扫码登录实现逻辑。</p>
<p>登录界面 <a href="https://login.taobao.com/member/login.jhtml" target="_blank" rel="external">https://login.taobao.com/member/login.jhtml</a> 传回来的参数为：</p>
<p>然后请求(GET)报文是这样的:</p>
<pre><code>https://qrlogin.taobao.com/qrcodelogin/qrcodeLoginCheck.do?
lgToken=2c3b4d53ef0513787bf4ce711ea5ba53&amp;defaulturl=&amp;_ksTS=1540106757739_2804&amp;callback=jsonp2805
</code></pre><p>关键的就是lgToken，是网页的唯一ID，当打开了二维码登录的时候，网页在轮询(应该是长轮询long polling)调用接口去请求服务器。扩展：彻底理解cookie，session，token</p>
<p>如果没有扫码，返回的为：</p>
<p>如果扫了的话则会返回：</p>
<pre><code>{

    &quot;code&quot;: &quot;10001&quot;,

    &quot;message&quot;: &quot;mobile scan QRCode success&quot;,

    &quot;success&quot;: true

}
</code></pre><p>长时间没有扫码的话，网页端会停止轮询，二维码失效！</p>
<p>当手机端确认登录后，接口返回的是：</p>
<pre><code>{ 
&quot;code&quot;: &quot;10006&quot;, 
&quot;success&quot;: true,
 &quot;url&quot;: &quot;https://login.taobao.com/member/loginByIm.do?uid=cntaobaoxxx&amp;token=ff82fc0d1d395a33d3b38ec5a4981336&amp;time=1530179143250&amp;asker=qrcodelogin&amp;ask_version=1.0.0&amp;defaulturl=https://www.taobao.com&amp;webpas=0b7aed2d43f01825183e4a49c6cae47d1479929926&quot;
}
</code></pre><p>表示登录成功，当然手机端与服务端在点击”确认登录”之间的交互可能就是这样：网页端生成的lgToken去请求服务端，服务端记住了这个lgToken并认为登录了，当网页端再次轮询请求接口时，就返回真正的登录态Token，网页端此时就可以凭着这个Token来登录了。</p>
<p>详细的技术逻辑如下图所示：</p>
<p><img src="http://www.52im.net/data/attachment/forum/202001/06/212653o685grmsmldylv36.png" alt=""></p>
<p>##4、微信的扫码登录技术实现</p>
<p>###4.1 技术原理流程图<br><img src="http://www.52im.net/data/attachment/forum/202001/06/213927pve6vavng8iavy4v.png" alt=""></p>
<p>微信的网页版访问地址是：<a href="https://wx.qq.com/，有兴趣也可以自行深入研究。" target="_blank" rel="external">https://wx.qq.com/，有兴趣也可以自行深入研究。</a></p>
<p>###4.2 实际的技术实现逻辑</p>
<p>####1）获取唯一的uuid, 以及包含uid信息的二维码：</p>
<p>// 获取uuid</p>
<pre><code>getUUID: function() {

    vare = t.defer();

    returnwindow.QRLogin = {},

    $.ajax({

        url: i.API_jsLogin,

        dataType: &quot;script&quot;

    }).done(function() {

        200 == window.QRLogin.code ? e.resolve(window.QRLogin.uuid) : e.reject(window.QRLogin.code)

    }).fail(function() {

        e.reject()

    }),

    e.promise

}
</code></pre><p>####2）浏览器轮询服务器，获取扫码状态：</p>
<p>// 查看扫码状态</p>
<pre><code>checkLogin: function(e, a) {

    varn = t.defer()

        , a = a || 0;

    returnwindow.code = 0,

    window.checkLoginPromise = $.ajax({

        url: i.API_login + &quot;?loginicon=true&amp;uuid=&quot;+ e + &quot;&amp;tip=&quot;+ a + &quot;&amp;r=&quot;+ ~newDate,

        dataType: &quot;script&quot;,

        timeout: 35e3

    }).done(function() {

        newRegExp(&quot;/&quot;+ location.host + &quot;/&quot;);

        if(window.redirect_uri &amp;&amp; window.redirect_uri.indexOf(&quot;/&quot;+ location.host + &quot;/&quot;) &lt; 0)

            returnvoid (location.href = window.redirect_uri);

        vare = {

            code: window.code,

            redirect_uri: window.redirect_uri,

            userAvatar: window.userAvatar

        };

        n.resolve(e)

    }).fail(function() {

        n.reject()

    }),

    n.promise

}
</code></pre><p>####3）根据服务器返回的扫码状态，进行相应的操作：</p>
<p>408 扫码超时：如果手机没有扫码或没有授权登录，服务器会阻塞约25s，然后返回状态码 408 -&gt; 前端继续轮询</p>
<p>400 二维码失效：大约5分钟的时间内不扫码，二维码失效</p>
<p>201 已扫码：如果手机已经扫码，服务器立即返回状态码和用户的基本信息 （window.code=201,window.code.userAvator=”…”），-&gt; 前端继续轮询</p>
<p>200 已授权：如果手机点击了确认登录，服务器返回200及token -&gt; 前端停止轮询, 获取到token，重定向到目标页</p>
<p>具体的代码示例如下：</p>
<p>// 根据服务器返回的扫码状态，进行相应的操作</p>
<pre><code>functiono(c) {
    switch(c.code) {
    case200:
        t.newLoginPage(c.redirect_uri).then(function(t) {
            varo = t.match(/&lt;ret&gt;(.*)&lt;\/ret&gt;/)
                , r = t.match(/&lt;script&gt;(.*)&lt;\/script&gt;/)
                , c = t.match(/&lt;skey&gt;(.*)&lt;\/skey&gt;/)
                , s = t.match(/&lt;wxsid&gt;(.*)&lt;\/wxsid&gt;/)
                , l = t.match(/&lt;wxuin&gt;(.*)&lt;\/wxuin&gt;/)
                , d = t.match(/&lt;pass_ticket&gt;(.*)&lt;\/pass_ticket&gt;/)
                , f = t.match(/&lt;message&gt;(.*)&lt;\/message&gt;/)
                , u = t.match(/&lt;redirecturl&gt;(.*)&lt;\/redirecturl&gt;/);
            returnu ? void (window.location.href = u[1]) : o &amp;&amp; &quot;0&quot;!= o[1] ? (alert(f &amp;&amp; f[1] || &quot;登录失败&quot;),
            i.report(i.AUTH_FAIL_COUNT, 1),
            void location.reload()) : (e.$emit(&quot;newLoginPage&quot;, {
                Ret: o &amp;&amp; o[1],
                SKey: c &amp;&amp; c[1],
                Sid: s &amp;&amp; s[1],
                Uin: l &amp;&amp; l[1],
                Passticket: d &amp;&amp; d[1],
                Code: r
            }),

            void (a.getCookie(&quot;webwx_data_ticket&quot;) || n.report(n.ReportType.cookieError, {
                text: &quot;webwx_data_ticket 票据丢失&quot;,
                cookie: document.cookie
            })))
        });
        break;

    case201:
        e.isScan = !0,
        n.report(n.ReportType.timing, {
            timing: {
                scan: Date.now()
            }
        }),
        t.checkLogin(e.uuid).then(o, function(t) {
            !t &amp;&amp; window.checkLoginPromise &amp;&amp; (e.isBrokenNetwork = !0)
        });
        break;

    case408:
        t.checkLogin(e.uuid).then(o, function(t) {
            !t &amp;&amp; window.checkLoginPromise &amp;&amp; (e.isBrokenNetwork = !0)
        });
        break;

    case400:

    case500:

    case0:
        vars = a.getCookie(&quot;refreshTimes&quot;) || 0;
        s &lt; 5 ? (s++,
        a.setCookie(&quot;refreshTimes&quot;, s, .5),
        document.location.reload()) : e.isNeedRefresh = !0;
        break;

    case202:
        e.isScan = !1,
        e.isAssociationLogin = !1,
        a.setCookie(&quot;login_frequency&quot;, 0, 2),
        window.checkLoginPromise &amp;&amp; (window.checkLoginPromise.abort(),
        window.checkLoginPromise = null),
        r()
    }

    e.code = c.code,
    e.userAvatar = c.userAvatar,
    a.log(&quot;get code&quot;, c.code)

}
</code></pre><p>###4.3 小结</p>
<p>微信网页端扫码登录时，轮询的数据返回采用的是JSONP的形式，这是为了解决跨域问题。如对JSONP不了解的，可以参考：</p>
<pre><code>http://www.52im.net/thread-1038-1-1.html
</code></pre><p>微信网页端扫码登录时，轮询采用了后台根据扫码情况阻塞前台请求，优化轮询及减少前端的无效轮询。这种技术，请详见：</p>
<pre><code>http://www.52im.net/thread-338-1-1.html
</code></pre><p>##5、本文小结</p>
<p>扫码登录这个功能，现在已经不只出现有IM应用里，各种带有移动端的线上网站也都有了这个功能，所以本文中介绍的技术原理并不局限于只用于实现IM应用中的扫码登录。</p>
<p>另外，为了方便抓取真实的数据进行分析研究，本文中的PC端案例分析是针对的是网页端，但实际上如果你的PC端是富客户端（也就是.exe、.dmg这样的安装版），原理也是一样的，而且还不需要考虑浏览器里的跨域问题等。</p>
<p>阅读本文时，可能涉及到传统的Web端即时通讯技术（为了扫码登录的实时性），比如长轮询等，如果您对这些技术还不太了解的话，可以系统学习一下即时通讯网整理的有关Web端即时通讯方面的资料。</p>
<hr>
<p>本文参考链接1：<a href="https://mp.weixin.qq.com/s/ND6vF_HAueH8GuQJzPkiBg" target="_blank" rel="external">来源微信公众号</a></p>
<p>本文参考链接2：<a href="http://www.52im.net/forum.php?mod=viewthread&amp;tid=2892" target="_blank" rel="external">即时通讯网</a></p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/01/10/php56-an-invalid-compatibility-problem-with-the-sign-of-an-image-uploaded-via-curl/" itemprop="url">
                  PHP5.6通过CURL上传图片@符无效的兼容问题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2020-01-10T20:26:00+08:00" content="2020-01-10">
              2020-01-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术日记/" itemprop="url" rel="index">
                    <span itemprop="name">技术日记</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>今天本来想试试一个图片云的API，于是本地做了个上传图片的测试，结果灰常郁闷的发现以前一直用的好好的CURL上传图片居然死活不起作用，本来几分钟搞定的事情，结果折腾了大半天才终于找到原因，居然是兼容性问题，真是无语。。</p>
<p>网上搜索PHP通过CURL上传图片几乎都是类似下面的代码：</p>
<pre><code>&lt;?php
header(&apos;Content-type:text/html; charset=utf-8&apos;); //声明编码
$ch = curl_init();
$url = &apos;https://xxx.com/api/mobile/auto_upload.php?uid=9705459&apos;;

//post数据，使用@符号，curl就会认为是有文件上传
$curlPost = array(&apos;Filedata&apos;=&gt;&apos;@/Users/finup/Documents/11.png&apos;);


curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_HEADER, 1);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_POST, 1); //POST提交
curl_setopt($ch, CURLOPT_POSTFIELDS,$curlPost);
$data =curl_exec($ch);
curl_close($ch);
echo &apos;&lt;pre&gt;&apos;;
var_dump($data);
</code></pre><p>以前上传图片都是在图片路径前面增加一个 @符号，如：</p>
<pre><code>$file = __DIR__ .&apos;/0634134726bc5b8b.jpg&apos;;
$data = array(&apos;mypic&apos;=&gt;&apos;@&apos;. $file);
</code></pre><p>这样就行了，但现在这种情况一般只适用于 PHP5.6以下的版本。<br>对5.6来说，直接加@是木有用的啦。</p>
<p>解决办法有两个：一种是兼容；二是使用新的方法。</p>
<p>1 . 兼容方法：<br>主要用到 CURL 的一个配置参数 CURLOPT_SAFE_UPLOAD<br>CURLOPT_SAFE_UPLOAD 在 PHP5.5中默认值是 false<br>而在 PHP5.6中已经默认为 true 了。<br>所以只需要增加一行强制设置为 false 就行，如下：</p>
<p><strong>注意：该参数的设置顺序，必须在设置 CURLOPT_POSTFIELDS 参数之前才有效哦！！！</strong></p>
<pre><code>&lt;?php
$url = &apos;http://127.0.0.1/test3.php&apos;;
$file = __DIR__ .&apos;/0634134726bc5b8b.jpg&apos;;
$data = array(&apos;mypic&apos;=&gt;&apos;@&apos;. $file);
$curl = curl_init();
curl_setopt($curl, CURLOPT_URL, $url);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
curl_setopt($curl, CURLOPT_POST, true);
curl_setopt($curl, CURLOPT_SAFE_UPLOAD, false);
curl_setopt($curl, CURLOPT_POSTFIELDS, $data);
$content = curl_exec($curl);
curl_close($curl);
print_r($content);
</code></pre><p>2 . 新的图片上传方法：<br>使用 CURLFile 类来处理文件，如下：</p>
<pre><code>$url = &apos;http://127.0.0.1/test3.php&apos;;
$file = __DIR__ .&apos;/0634134726bc5b8b.jpg&apos;;
$data = array(&apos;mypic&apos;=&gt;new CURLFile($file));
$curl = curl_init();
curl_setopt($curl, CURLOPT_URL, $url);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
curl_setopt($curl, CURLOPT_POST, true);
curl_setopt($curl, CURLOPT_POSTFIELDS, $data);
$content = curl_exec($curl);
curl_close($curl);
print_r($content);
</code></pre><p>我这里只是最简单的应用，具体可参考下面官方文档：<br><a href="http://php.net/manual/en/class.curlfile.php" target="_blank" rel="external">http://php.net/manual/en/class.curlfile.php</a></p>
<p>这下终于上传成功了。。。太坑爹了，一天时间又被折腾完了。</p>
<p>最后，注意使用CURLFile类时的一个问题：</p>
<p>CURLFile的第三个参数，如果使用的话，要么带上后缀的文件全名；要么整个空着。不能有值又不带后缀，否则DZ系统默认上传失败，因为获取文件扩展名为空。</p>
<p>当然，如果像上面示例一样只有一个文件路径本身，其他全都是缺省值（默认值），服务器会自动获取其他文件属相参数，反而是一个更好的方案。</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/12/28/ios-support-universal-links/" itemprop="url">
                  iOS 支持通用链接UniversalLinks
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2019-12-28T17:00:00+08:00" content="2019-12-28">
              2019-12-28
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/服务器/" itemprop="url" rel="index">
                    <span itemprop="name">服务器</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>iOS 支持通用链接UniversalLinks</p>
<p>关于iOS中的Universal Links（通用链接）分三部分讲解一下。<br>这个功能是从 iOS 9 之后开始支持的。</p>
<hr>
<h3 id="第一部分：一篇文章《iOS微信里打开app，Universal-Links》"><a href="#第一部分：一篇文章《iOS微信里打开app，Universal-Links》" class="headerlink" title="第一部分：一篇文章《iOS微信里打开app，Universal Links》"></a>第一部分：一篇文章《iOS微信里打开app，Universal Links》</h3><p>从第三方应用或者浏览器打开自己app的东西</p>
<p>传统的方式是通过URL Scheme的方式，但是iOS9以后又出了新的更完美的方式Universal Links。</p>
<p>传统的URL Scheme方式微信内置的浏览器都是封锁了所有它投资的公司之外的，只有白名单的才可以（比如京东，B站，等）。Universal Links也不能算是完美的实现，但是已经是目前为止最好的了。</p>
<p>就说一下这个东西的介绍，就像在windows里面为某一类型的文件添加了默认的打开方式。只不过这个文件类型变成了某一个“域名”（并非完全是某个域名，或者可以称之为某段有特殊意义的URL）的URL。这个东西只能在iOS9以后才有。</p>
<p>具体的表现在在iOS系统中，当你邮件或者短信或者其他方式收到含有某段“特定标示”的URL的时候如果安装有你的app，就可以直接默认调用app去打开，否则只能调用你的Safari去打开。具体到微信里面就是打开了分享的H5，右上角更多－在Safari中打开，可以直接调用你的app去打开这个URL。具体在app的中怎么展示相关的逻辑就看你的了。</p>
<h4 id="具体介绍的相关文章："><a href="#具体介绍的相关文章：" class="headerlink" title="具体介绍的相关文章："></a>具体介绍的相关文章：</h4><p>苹果文档：<br><a href="https://developer.apple.com/library/ios/documentation/General/Conceptual/AppSearch/UniversalLinks.html" target="_blank" rel="external">https://developer.apple.com/library/ios/documentation/General/Conceptual/AppSearch/UniversalLinks.html</a></p>
<p>苹果检测链接有效性：<br><a href="https://search.developer.apple.com/appsearch-validation-tool/" target="_blank" rel="external">https://search.developer.apple.com/appsearch-validation-tool/</a></p>
<p>很棒的一个英文的步骤文章：<br><a href="https://blog.branch.io/how-to-setup-universal-links-to-deep-link-on-apple-ios-9" target="_blank" rel="external">https://blog.branch.io/how-to-setup-universal-links-to-deep-link-on-apple-ios-9</a></p>
<p>相关的文章：<a href="http://www.jackivers.me/blog/2015/9/17/list-of-universal-link-ios-9-apps" target="_blank" rel="external">http://www.jackivers.me/blog/2015/9/17/list-of-universal-link-ios-9-apps</a></p>
<p><a href="http://tech.glowing.com/cn/deferred-deep-linking-and-branch-sdk-in-ios/（URL" target="_blank" rel="external">http://tech.glowing.com/cn/deferred-deep-linking-and-branch-sdk-in-ios/（URL</a> Scheme和Universal Links优缺点介绍的很棒，这个团队的技术博客也很不错哦）</p>
<p><a href="http://www.cocoachina.com/ios/20150911/13321.html（里面的那个运行流程的总结图很不错）" target="_blank" rel="external">http://www.cocoachina.com/ios/20150911/13321.html（里面的那个运行流程的总结图很不错）</a></p>
<p>具体的步骤就不再赘述了，因为无论是官方文档，还是其他人写的文章都很棒了，我就说一下实际开发中可能遇到的的坑。</p>
<p>1.注意拼写那个json文件的时候，应该是你的开发者中心，Identifiers—App IDs— 应用的证书名字（bundle id所有对应的那个）—Prefix<br>.英文的点号，再跟上你的bundle id。并且文件的名字必须为“apple-app-site-association”，不能自己私自定义。用浏览器打开https://<domain>/apple-app-site-association文件，看一下成功否就可以了。</domain></p>
<p>2.生成后的json文件一定是要放到你的那些网页所在的站点的目录下面的HTTPS web server根目录下面。比如你的网站是<a href="https://www.google.com（所有的网页都是以这个开头的），然后你应用的地址baseurl是https://api.google.com，其实你应该放在www的那个HTTPS" target="_blank" rel="external">https://www.google.com（所有的网页都是以这个开头的），然后你应用的地址baseurl是https://api.google.com，其实你应该放在www的那个HTTPS</a> web server根目录下面。然后过两三分钟吧，就用苹果有效性检测工具的那个去试一下，找一个你要分享出去的h5链接试一下，只要不出错，出来很多的相关信息就可以了（就跟用这个URL测试出来的结果一样就可以了<a href="https://www.yelp.com/biz/michael-winnetka）。" target="_blank" rel="external">https://www.yelp.com/biz/michael-winnetka）。</a></p>
<p>3.在工程的设置Associated Domains的时候，一定先要去苹果的开发者中心打开你的应用证书Associated Domains Enabled。然后记得更新你的证书关联的东西，然后更新本地的证书。才可以打开工程的Associated Domains。记住填写链接的时候是applinks:<domain>。这个<domain>就是第1点中调试通的那个（如果你的应用的api的和页面的不区分服务器就一样了）。</domain></domain></p>
<p>4.然后编译你的应用。如果你在短信中含有类似的https://<domain>?a=1&amp;b=2 已经通过了后，直接长按会出来“在“XXX”中打开”就说明成功了。可以去微信微博等其他的地方去看看了。</domain></p>
<p>这一段内容来源链接（版权归属原作者）：<a href="https://www.cnblogs.com/ysk-china/p/5777299.html" target="_blank" rel="external">https://www.cnblogs.com/ysk-china/p/5777299.html</a></p>
<hr>
<h3 id="第二部分：一篇文章《iOS-9-通用链接（Universal-Links）》"><a href="#第二部分：一篇文章《iOS-9-通用链接（Universal-Links）》" class="headerlink" title="第二部分：一篇文章《iOS 9 通用链接（Universal Links）》"></a>第二部分：一篇文章《iOS 9 通用链接（Universal Links）》</h3><p>1.apple-app-site-association文件不能带后缀，务必把”.json”的后缀去掉！有些人的电脑是隐藏文件后缀的，这要格外注意；</p>
<p>2.apple-app-site-association一定要传到域名根目录下；</p>
<p>3.WebServer需要支持https，且https使用有效的证书（是私密链接）。笔者在这里卡了很久，原因就是后台给配的https使用无效的证书，导致应用安装的时候不能正确的下载apple-app-site-association文件；</p>
<p>4.如果想测试这个功能，可以让后台搭一个测试服务器，并配置虚拟主机生成域名，然后iOS这边通过host访问域名就可以了。注意”applink:”后面写的一定是域名，不能是IP；</p>
<p>5.抓包的结果显示，网络顺畅的情况下，应用会在在刚安装（不是打开）的时候会去applink中的地址下载apple-app-site-association文件，所以如果需要测试，请保证网络通畅；</p>
<p>6.当所有都准备好，需要测试该功能的时候，只需要在记事本或短信中输入App能识别的链接，然后直接点击或是长按就可以了，直接点的效果是跳转到你的App，然后右上角是“去网页”的箭头，长按的效果是弹出的菜单中第二项是“在’XXX’中打开”，这也代表着成功。直接在Safari中输入链接是无效的，必须从一处跳入才可以（比如上一级网页）。</p>
<p>7.苹果有个网址（这里）可以检测你的apple-app-site-association是否是有效的，准备好了可以测试一下。</p>
<p>8.测试的时候，建议使用dev证书打包，之后安装到手机上测试功能。未安装应用的情况下直接在手机上跑好像也是可以的，因为抓到过请求。</p>
<p>9.如果你有问题，但上面没有列出，Stackoverflow上面有个问题，可以看下其他人的建议。</p>
<h4 id="继续之前的补充几点"><a href="#继续之前的补充几点" class="headerlink" title="继续之前的补充几点"></a>继续之前的补充几点</h4><p>1.如果需要支持此功能，需要在开发者中心做配置。具体是这样：开发者中心-&gt;Identitiers-&gt;App IDs-&gt;需要支持的应用App ID，在Application Services列表里有Associated Domains一条，把它变为Enabled就可以了。</p>
<p>2.当你在项目targets-&gt;Capabilities-&gt;Associated Domains中配置app link之后，系统会自动帮你写入.entitlements文件，所以不需要自己去手动加。需要注意的是，有人遇到过.entitlements文件没有被加入工程的，这也会产生问题，需要手动把.entitlements加入工程。</p>
<p>3.apple-app-site-association文件里有个paths字段，这个是用来控制可识别链接的，星号的写法代表了可识别域名下所有链接。这篇博客里有很多其他公司的例子，可以参考一下。</p>
<p>这一段内容来源链接（版权归属原作者）：<a href="https://www.jianshu.com/p/c2ca5b5f391f" target="_blank" rel="external">https://www.jianshu.com/p/c2ca5b5f391f</a></p>
<hr>
<h3 id="第三部分-关于apple-app-site-association文件自己遇到的坑"><a href="#第三部分-关于apple-app-site-association文件自己遇到的坑" class="headerlink" title="第三部分 关于apple-app-site-association文件自己遇到的坑"></a>第三部分 关于apple-app-site-association文件自己遇到的坑</h3><p>Configure your website to host the apple-app-site-association file</p>
<ol>
<li>Buy a domain name or pick from your existing.</li>
<li>Acquire SSL certification for the domain name.</li>
<li>Create structured apple-app-site-association JSON file.</li>
<li>Sign the JSON file with the SSL certification.</li>
<li>Configure the file server.</li>
</ol>
<p>上面是一篇英文文章说明这个文件的配置过程，很准确。</p>
<p>但是，实际配置过程总遇到的问题有以下几点：</p>
<p>1、此文件在浏览器中访问时，默认是下载而不是打开显示文件内容。</p>
<p><strong>解决方法</strong>：在服务器对应项目的配置文件中增加</p>
<pre><code>location ~ apple-app-site-association$ {
    add_header  Content-Type &apos;text/plain&apos;;
}
</code></pre><p>2、上述方法解决了浏览器直接显示文件内容的问题，但是并不是返回的json格式数据，但是使用苹果的URL检测工具不通过，显示469错误。</p>
<p><strong>解决方法</strong>：在服务器对应项目的配置文件中增加</p>
<pre><code>location ~ apple-app-site-association$ {
    default_type application/json;
}
</code></pre><p>3、上述方法同时解决了显示文件内容和返回json格式的问题，也按上面的方案修改了，但是使用苹果的URL检测工具仍然不通过。</p>
<p><strong>解决方法</strong>：注意苹果官网检测工具的一句话“Applebot will crawl your webpage”，需要服务器允许苹果爬的访问权限（默认是禁止所有爬虫的）。在修改允许苹果爬虫Applebot之后，经检测工具检测，apple-app-site-association文件已有效可用。</p>
<p>另外2个问题说明：</p>
<p>1、配置过程中需要多次重启nginx服务器，并且清除浏览器缓存。</p>
<p>2、apple-app-site-association文件的内容是由iOS开发工程师配置好的，此处只涉及服务器上传此文件，并支持检测工具检测到可用状态。</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/10/29/AI-progress-you-do-not-know/" itemprop="url">
                  你所不知道的 AI 进展
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2019-10-29T12:02:00+08:00" content="2019-10-29">
              2019-10-29
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/未来探索/" itemprop="url" rel="index">
                    <span itemprop="name">未来探索</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>人工智能现在是常见词汇，大多数人可能觉得，它是学术话题，跟普通人关系不大。<br>但是实际上，AI 突飞猛进，正在脱离实验室，进入日常生活。仅仅是现在的技术水平，就足以模糊现实与虚拟的界限，颠覆一般民众的认知。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102801.jpg" alt=""></p>
<p>（图1：2018年10月，世界第一幅 AI 生成的肖像画，<a href="https://www.christies.com/features/A-collaboration-between-two-artists-one-human-one-a-machine-9332-1.aspx" target="_blank" rel="external">拍卖</a>成交价43.25万美元。）</p>
<p>为了让普通人了解 AI 的进展，谷歌的机器学习专家格里高利·萨普诺夫（Grigory Sapunov）写了一篇通俗的<a href="https://blog.inten.to/welcome-to-the-simulation-dd0d8cb6534d" target="_blank" rel="external">科普文章</a>，介绍目前的技术成果。这盘文章非常精彩，有大量的图片，加上一些简单的解释，信息量很大，对于了解技术动态很有帮助。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102802.jpg" alt=""></p>
<p>（图2：谷歌的机器学习专家格里高利·萨普诺夫）<br>下面就是那篇文章的翻译，比较长，图片很多，但是值得耐心读完。我保证，有些内容一定会让你感到吃惊。</p>
<h2 id="一、图像处理"><a href="#一、图像处理" class="headerlink" title="一、图像处理"></a>一、图像处理</h2><p>人工智能最早是从图像处理开始的。图像处理是一种常见任务，智能要求比较高，需要使用 PhotoShop 之类的软件人工编辑，一般的算法解决不了。</p>
<h3 id="1-1-对象补全"><a href="#1-1-对象补全" class="headerlink" title="1.1 对象补全"></a>1.1 对象补全</h3><p>2017年，日本科学家提出了一种<a href="https://web.archive.org/web/20191016060740/http://iizuka.cs.tsukuba.ac.jp/projects/completion/en/" target="_blank" rel="external">图像的对象补全模型</a>。经过训练，模型可以补全图片上缺失的部分。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102803.jpg" alt=""></p>
<p>（图3：图像的对象补全模型）<br>上图中，左边是原始图片，然后把中间的花盆涂掉，输入模型。模型会自动补全缺失的部分（右图），由于它不知道，那里有一个花盆，所以只会根据没有涂掉的部分，补上地板和扶手。<br>下面是更多这样的例子。涂掉的部分，模型都会补上，哪怕它根本不知道，那里原来是什么。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102804.jpg" alt=""></p>
<p>（图4：图像的对象补全示例）<br>Nvidia 公司将这个模型做成了产品，放在网上。你可以到<a href="https://www.nvidia.com/research/inpainting/" target="_blank" rel="external">它的网站</a>，上传一张图片，然后涂掉一些部分，让网站替你补全。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102805.jpg" alt=""></p>
<p>（图5：涂掉沙发旁边的茶几）<br>有的<a href="https://www.slashgear.com/adobes-entry-level-photoshop-elements-gets-new-ai-powered-tools-04594215/" target="_blank" rel="external">图像软件</a>已经应用这项技术，去除人像脸上的斑点。</p>
<h3 id="1-2-背景处理"><a href="#1-2-背景处理" class="headerlink" title="1.2 背景处理"></a>1.2 背景处理</h3><p>背景处理指的是，将前景物体从图片分离出来，再对背景进行加工。目前，已经有<a href="https://towardsdatascience.com/background-removal-with-deep-learning-c4f2104b3157" target="_blank" rel="external">很好的智能算法</a>可以去除图片背景。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102806.jpg" alt=""><br>（图6：图片的背景去除）<br>在模型内部，图片会转成像素的色块。下图的浅紫色块就是前景物体，然后再把这些像素提取出来。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102807.jpg" alt=""><br>（图7：背景去除模型）<br>这个模型也已经做成了<a href="https://www.remove.bg/" target="_blank" rel="external">线上服务</a>，大家可以上传图片感受一下它的效果。<br>既然可以去除背景，那当然就可以<a href="https://arxiv.org/abs/1703.03872" target="_blank" rel="external">更改背景</a>，为图片合成打开方便之门。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102808.jpg" alt=""><br>（图8：更改图片背景）</p>
<h3 id="1-3-样式转换"><a href="#1-3-样式转换" class="headerlink" title="1.3 样式转换"></a>1.3 样式转换</h3><p>人工智能还能够<a href="https://www.cv-foundation.org/openaccess/content_cvpr_2016/papers/Gatys_Image_Style_Transfer_CVPR_2016_paper.pdf" target="_blank" rel="external">识别</a>图片的风格样式（即像素的变化规律），将其套用在另一张图片。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102809.jpg" alt=""><br>（图9：原始图片）<br>上图是两张原始图片，第一张是梵高的名画《星夜》，第二张是普通的风景照。模型可以提取第一张图片的风格，将其套用在第二张图片。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102810.jpg" alt=""><br>（图10：套用梵高的《星夜》风格）<br>其他名画的风格，同样可以套用。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102812.jpg" alt=""><br><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102813.jpg" alt=""><br>（图11：图像的风格转换）</p>
<h3 id="1-4-图像着色"><a href="#1-4-图像着色" class="headerlink" title="1.4 图像着色"></a>1.4 图像着色</h3><p>一旦识别出图片中的物体，模型就可以统计不同物体的像素颜色规律，然后就能推断黑白照片可能的颜色，从而实现<a href="https://arxiv.org/abs/1603.06668" target="_blank" rel="external">照片着色</a>。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102814.jpg" alt=""><br>（图12：黑白照片的着色）<br>网上也有免费的<a href="https://colorize.cc/" target="_blank" rel="external">着色服务</a>，大家可以体验。</p>
<h2 id="二、GAN-方法"><a href="#二、GAN-方法" class="headerlink" title="二、GAN 方法"></a>二、GAN 方法</h2><h3 id="2-1-简介"><a href="#2-1-简介" class="headerlink" title="2.1 简介"></a>2.1 简介</h3><p>GAN 是”生成对抗网络”（Generative Adversarial Networks）的缩写，它是一种革命性的提升人工智能模型效果、生成虚拟图像的方法。<br>原理很简单，就是两个神经网络互相对抗。一个神经网络负责生成虚拟图像，另一个神经网络负责鉴定假图像。理论上，如果 GAN 训练成功，那么生成的假图像与真图像将无法区分。2014年，这种方法提出以后，快速发展，目前效果已经可以乱真。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102815.jpg" alt=""><br>（图13：GAN 的改进速度）<br>上图是过去几年，GAN 生成的虚拟人像。可以发现，每过一年，图片越来越大，细节越来越丰富，越发接近真实人像。它的工作方法也是如此，第一步生成一张低分辨率图片，然后慢慢放大，依次修改每一个像素，确定该像素怎样才能最大概率通过鉴定器。<br>GAN 不仅能生成虚拟图像，还能生成音频、文本，甚至是化合物分子。AI 模型可能创造出来的任何东西，都能使用 GAN 提升效果。GitHub 有一个<a href="https://github.com/hindupuravinash/the-gan-zoo" target="_blank" rel="external">仓库</a>，专门收集不同用途的 GAN，目前已经有500多种模型。</p>
<h3 id="2-2-StyleGAN"><a href="#2-2-StyleGAN" class="headerlink" title="2.2 StyleGAN"></a>2.2 StyleGAN</h3><p>目前，生成虚拟人像效果最好的模型是 Nvidia 公司的 <a href="https://arxiv.org/abs/1812.04948" target="_blank" rel="external">StyleGAN</a>。下面两张头像，你能分辨哪张是虚拟的，哪张是真实的吗？</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102816.jpg" alt=""><br>（图14：GAN 虚拟人像）<br>这是网站截图，你可以去<a href="http://www.whichfaceisreal.com/" target="_blank" rel="external">那个网站</a>试试看，能猜对多少张。需要提醒的是，这是2018年底的模型产物，随着模型进化，迟早将无法分辨真假。<br>GAN 不仅能生成人像，实际上可以生成任何图像。下面是 <a href="https://arxiv.org/abs/1809.11096" target="_blank" rel="external">BigGAN</a> 模型生成的各种图像，图片里的东西都是不存在的。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102817.jpg" alt=""><br>（图15：BigGAN 模型生成的虚拟图像）</p>
<h3 id="2-3-图像翻译"><a href="#2-3-图像翻译" class="headerlink" title="2.3 图像翻译"></a>2.3 图像翻译</h3><p>一种图像通过 GAN 转变为另一种图像，称为图像翻译。空拍照片变成地图、黑白照片变成彩色照片，都是图像翻译的例子。<br><a href="https://github.com/phillipi/pix2pix" target="_blank" rel="external">pix2pix</a> 是图像翻译的开源工具，它可以让黑夜变成白天，示意图变成实物图。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102818.jpg" alt=""><br>（图16：图像翻译）<br>也可以让春天变成夏天，晴天变成雨天。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102819.jpg" alt=""><br>（图17：图像翻译）<br>图像翻译的难点在于，它需要有成对的示例（源图像和相应的目标图像），告诉模型应该怎么翻译，这些示例可能很难创建。但是反过来，只要有配对的示例，就可以翻译图像，不管这种翻译是否合理。下面是两只小猫翻译成对应的豹子、狮子和老虎。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102820.jpg" alt=""><br>（图18：图像翻译）<br><a href="https://github.com/junyanz/CycleGAN" target="_blank" rel="external">CycleGAN</a> 模型还支持跨域翻译，将照片翻译成油画，斑马翻译成马。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102821.jpg" alt=""><br>（图19：图像翻译）<br>Nvidia 开发了一个 <a href="http://nvidia-research-mingyuliu.com/gaugan" target="_blank" rel="external">GauGAN</a> 软件，可以在线试玩。用户只需手绘一个示意图，软件就能生成一张对应的风景照片。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102829.jpg" alt=""><br>（图20：GauGAN 将示意图变成照片）</p>
<h3 id="2-4-人像翻译"><a href="#2-4-人像翻译" class="headerlink" title="2.4 人像翻译"></a>2.4 人像翻译</h3><p>图像翻译用于人像，就是人像翻译。<a href="https://github.com/yunjey/StarGAN" target="_blank" rel="external">StarGAN</a> 模型可以翻译面部属性，比如头发的颜色、性别、肤色等。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102824.jpg" alt=""><br>（图21：脸部属性的改变）<br>还可以把其他人的表情移植到你的脸上，下图分别是愤怒、快乐、恐惧的表情翻译。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102825.jpg" alt=""><br>（图22：表情的改变）<br><a href="https://github.com/run-youngjoo/SC-FEGAN" target="_blank" rel="external">SC-FEGAN</a> 是人像翻译的开源软件，可以让你编辑人像，比如加上刘海，去除墨镜等等。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102826.jpg" alt=""><br><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102827.jpg" alt=""><br>（图23：人像编辑软件 SC_FEGAN）</p>
<h3 id="2-5-文本到图像生成"><a href="#2-5-文本到图像生成" class="headerlink" title="2.5 文本到图像生成"></a>2.5 文本到图像生成</h3><p>GAN 最惊人的成果之一，大概就是<a href="https://arxiv.org/abs/1711.10485" target="_blank" rel="external">根据文本生成图像</a>。用户提供一个句子，软件生成对应的图像。原始文本”一只红中透白、长着非常短的尖嘴的鸟”，可以得到下面的图像。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102830.jpg" alt=""><br>（图24：根据文本生成图像）<br>论文甚至提到，将来存在可能，根据剧本直接生成一部电影。</p>
<h2 id="三、视频生成"><a href="#三、视频生成" class="headerlink" title="三、视频生成"></a>三、视频生成</h2><p>图像处理逐渐成熟以后，人工智能业界的关注重点就转向了视频。<br>从一个视频生成另一个视频，这就叫视频翻译。目前比较成熟的两个方向是运动传递和面部交换。</p>
<h3 id="3-1-运动传递"><a href="#3-1-运动传递" class="headerlink" title="3.1 运动传递"></a>3.1 运动传递</h3><p>运动传递指的是，将一个人的动作（包括身体、眼睛或嘴唇的动作）翻译到另一个人身上，使得另一个人出现一模一样的动作。<br>2018的论文<a href="https://carolineec.github.io/everybody_dance_now/" target="_blank" rel="external">《Everybody Dance Now》</a>，给出了一个模型，可以将舞者的动作移植到任何人身上。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102831.jpg" alt=""><br>（图25：动作传递）<br>上图中，蓝衣女子的跳舞视频完全是假的，是将左上角舞者的动作套用在她身上，自动生成的。<br>NVIDIA 公司的开源软件 <a href="https://github.com/NVIDIA/vid2vid" target="_blank" rel="external">vid2vid</a> 更为强大，可以生成高分辨率的、连贯的逼真视频。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102832.jpg" alt=""><br>（图26：vidvid 软件）</p>
<h3 id="3-2-脸部生成"><a href="#3-2-脸部生成" class="headerlink" title="3.2 脸部生成"></a>3.2 脸部生成</h3><p>脸部生成指的是，根据一张脸的表情和动作，重建另一张脸。最著名的例子是虚拟的<a href="http://grail.cs.washington.edu/projects/AudioToObama/" target="_blank" rel="external">奥巴马演讲</a>。2017年，华盛顿大学的团队发表了一段奥巴马的演讲视频。奥巴马其实从未做过这个演讲，是将别人的表情和口型套在他脸上生成的，语音也是合成的。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102833.jpg" alt=""><br>（图27：虚拟的奥巴马演讲）<br>这种伪造的视频被称为 <a href="https://en.wikipedia.org/wiki/Deepfake" target="_blank" rel="external">Deepfake</a>（深度伪造），具有很大的欺骗性，许多在线平台都禁止上传这一类视频。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102834.jpg" alt=""><br>（图28：伪造的特朗普演讲，将喜剧演员的表演变成特朗普自己在讲。）</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102837.jpg" alt=""><br>（图29：深度伪造的普京）<br>2018年出现的<a href="https://web.stanford.edu/~zollhoef/papers/SG2018_DeepVideo/page.html" target="_blank" rel="external">《深度视频肖像》</a>更进了一步，生成的视频不局限于虚拟的面部表情，还会头部旋转、眼睛凝视和眨眼，是 3D 的肖像重构。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102835.jpg" alt=""><br>（图29：深度视频肖像）<br>这些技术还在<a href="https://www.theverge.com/2019/6/10/18659432/deepfake-ai-fakes-tech-edit-video-by-typing-new-words" target="_blank" rel="external">继续发展</a>，现在你可以给出任意文本，从任何你指定的对象嘴里说出来。甚至只凭一张照片，就可以生成一段表情变化的视频。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102836.jpg" alt=""><br>（图30：一张照片生成各种表情）</p>
<h3 id="3-3-中国的实践"><a href="#3-3-中国的实践" class="headerlink" title="3.3 中国的实践"></a>3.3 中国的实践</h3><p>国内的人工智能视频生成，并不落后于国外。换脸应用 ZAO 只需用户上传一张照片，就能把影视剧主人公的脸换掉，好像你本人在表演电影一样。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102838.jpg" alt=""><br>（图31：换脸应用 ZAO）<br>2018年，新华社与搜狗合作推出了虚拟新闻主播，具有真人的形象，带有声音、面部表情和动作，在电视上播报新闻，已经开通了英语、俄语、阿拉伯语的主持人。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102839.jpg" alt=""><br>（图32：虚拟新闻主播）</p>
<h3 id="3-4-视频渲染"><a href="#3-4-视频渲染" class="headerlink" title="3.4 视频渲染"></a>3.4 视频渲染</h3><p>除了视频生成，人工智能在视频渲染上也取得了很大进展。<br>Nvidia 公司2018年展示了实时光线追踪 RTX 技术。这项技术用人工智能预测光线的变化，从而不用耗费大量计算去追踪光线，因此可以实时渲染出高画质的 3D 动画。这对于视频游戏有重大意义。<br>下面是使用这项技术的 Unreal Engine 4，实时渲染出的一个女子的<a href="https://venturebeat.com/2018/03/21/epic-games-shows-off-amazing-real-time-digital-human-with-siren-demo/" target="_blank" rel="external">3D 动画</a>，可以一边计算生成，一边播放，完全没有延迟。</p>
<p><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102840.jpg" alt=""><br><img src="https://www.wangbase.com/blogimg/asset/201910/bg2019102841.jpg" alt=""><br>（图32：实时渲染的动画）<br>实时光线追踪技术还可以用于自动驾驶，在白天和黑夜的不同时间，不同的路面和环境下，预测出暴雨、风雪和强烈的眩光导致的光线变化，对驾驶做出调整。</p>
<h2 id="四、文本和声音处理"><a href="#四、文本和声音处理" class="headerlink" title="四、文本和声音处理"></a>四、文本和声音处理</h2><p>最后，简单提一下，人工智能在文本和声音处理领域的进展。</p>
<h4 id="（1）语音合成"><a href="#（1）语音合成" class="headerlink" title="（1）语音合成"></a>（1）语音合成</h4><p>谷歌在2018年推出了智能助手 Google Duplex，它会根据你的日程，自动打电话去餐厅订座位。谷歌 CEO 说，这个机器人的对话能力，使得对方完全没有发现这是机器人。</p>
<h4 id="（2）音乐合成"><a href="#（2）音乐合成" class="headerlink" title="（2）音乐合成"></a>（2）音乐合成</h4><p>OpenAI 基金会推出的 <a href="https://openai.com/blog/musenet/" target="_blank" rel="external">MuseNet</a>，通过学习数十万段 MIDI 音乐，能做到使用10种乐器，生成一段4分钟的音乐。它的官网有这些音乐的下载，相当动听。</p>
<h4 id="（3）自动评论"><a href="#（3）自动评论" class="headerlink" title="（3）自动评论"></a>（3）自动评论</h4><p>据报道，使用 Yelp 网站的数据进行训练的模型，可以自动生成餐厅评论。</p>
<pre><code>- 我喜欢这个地方，一直来这里已经好多年。它是与朋友和家人相聚的好地点，我喜欢这里的食物和服务，从未有过糟糕的经历。
- 我吃了烤蔬菜汉堡配薯条！哦，很好吃！
- 我和我的家人都是这个地方的忠实粉丝。工作人员超级好，食物也很棒。鸡肉很好，大蒜酱也很完美。配水果的冰淇淋也很美味。强烈推荐！
- 上面这些都是机器生成的评论。
</code></pre><h4 id="（4）智能邮件"><a href="#（4）智能邮件" class="headerlink" title="（4）智能邮件"></a>（4）智能邮件</h4><p>Gmail 会根据电子邮件的来信内容，自动生成<a href="https://www.blog.google/products/gmail/save-time-with-smart-reply-in-gmail/" target="_blank" rel="external">三种不同的回复</a>，让用户选择。如果只是简单回应，用户不用自己动手写。<br>Gmail 的<a href="https://ai.googleblog.com/2018/05/smart-compose-using-neural-networks-to.html" target="_blank" rel="external">另一个功能</a>是，根据用户已经写的内容，预测接下来会写的句子，供用户选择。</p>
<h2 id="五、小结"><a href="#五、小结" class="headerlink" title="五、小结"></a>五、小结</h2><p>毫无疑问，人工智能是很酷的技术，创造出了神奇的产品，有着难以想象的巨大应用前景。<br>但是，人工智能也是一把双刃剑，模糊了现实与虚拟之间的界限，把我们带上了一条不可预测的道路。作为个人，了解这些技术的进展和潜力，有助于保持一份清醒，享受技术之福的同时，避免它带来的一些副作用。<br>（正文完）</p>
<hr>
<p>References</p>
<p>[1] 拍卖: <a href="https://www.christies.com/features/A-collaboration-between-two-artists-one-human-one-a-machine-9332-1.aspx" target="_blank" rel="external">https://www.christies.com/features/A-collaboration-between-two-artists-one-human-one-a-machine-9332-1.aspx</a><br>[2] 科普文章: <a href="https://blog.inten.to/welcome-to-the-simulation-dd0d8cb6534d" target="_blank" rel="external">https://blog.inten.to/welcome-to-the-simulation-dd0d8cb6534d</a><br>[3] 腾讯课堂: <a href="https://ke.qq.com/?utm=ruanyifeng" target="_blank" rel="external">https://ke.qq.com/?utm=ruanyifeng</a><br>[4] “腾讯课堂101计划”: <a href="https://edu.qq.com/a/20190119/005414.htm" target="_blank" rel="external">https://edu.qq.com/a/20190119/005414.htm</a><br>[5] 图像的对象补全模型: <a href="https://web.archive.org/web/20191016060740/http://iizuka.cs.tsukuba.ac.jp/projects/completion/en/" target="_blank" rel="external">https://web.archive.org/web/20191016060740/http://iizuka.cs.tsukuba.ac.jp/projects/completion/en/</a><br>[6] 它的网站: <a href="https://www.nvidia.com/research/inpainting/" target="_blank" rel="external">https://www.nvidia.com/research/inpainting/</a><br>[7] 图像软件: <a href="https://www.slashgear.com/adobes-entry-level-photoshop-elements-gets-new-ai-powered-tools-04594215/" target="_blank" rel="external">https://www.slashgear.com/adobes-entry-level-photoshop-elements-gets-new-ai-powered-tools-04594215/</a><br>[8] 很好的智能算法: <a href="https://towardsdatascience.com/background-removal-with-deep-learning-c4f2104b3157" target="_blank" rel="external">https://towardsdatascience.com/background-removal-with-deep-learning-c4f2104b3157</a><br>[9] 线上服务: <a href="https://www.remove.bg/" target="_blank" rel="external">https://www.remove.bg/</a><br>[10] 更改背景: <a href="https://arxiv.org/abs/1703.03872" target="_blank" rel="external">https://arxiv.org/abs/1703.03872</a><br>[11] 识别: <a href="https://www.cv-foundation.org/openaccess/content_cvpr_2016/papers/Gatys_Image_Style_Transfer_CVPR_2016_paper.pdf" target="_blank" rel="external">https://www.cv-foundation.org/openaccess/content_cvpr_2016/papers/Gatys_Image_Style_Transfer_CVPR_2016_paper.pdf</a><br>[12] 照片着色: <a href="https://arxiv.org/abs/1603.06668" target="_blank" rel="external">https://arxiv.org/abs/1603.06668</a><br>[13] 着色服务: <a href="https://colorize.cc/" target="_blank" rel="external">https://colorize.cc/</a><br>[14] 仓库: <a href="https://github.com/hindupuravinash/the-gan-zoo" target="_blank" rel="external">https://github.com/hindupuravinash/the-gan-zoo</a><br>[15] StyleGAN: <a href="https://arxiv.org/abs/1812.04948" target="_blank" rel="external">https://arxiv.org/abs/1812.04948</a><br>[16] 那个网站: <a href="http://www.whichfaceisreal.com/" target="_blank" rel="external">http://www.whichfaceisreal.com/</a><br>[17] BigGAN: <a href="https://arxiv.org/abs/1809.11096" target="_blank" rel="external">https://arxiv.org/abs/1809.11096</a><br>[18] pix2pix: <a href="https://github.com/phillipi/pix2pix" target="_blank" rel="external">https://github.com/phillipi/pix2pix</a><br>[19] CycleGAN: <a href="https://github.com/junyanz/CycleGAN" target="_blank" rel="external">https://github.com/junyanz/CycleGAN</a><br>[20] GauGAN: <a href="http://nvidia-research-mingyuliu.com/gaugan" target="_blank" rel="external">http://nvidia-research-mingyuliu.com/gaugan</a><br>[21] StarGAN: <a href="https://github.com/yunjey/StarGAN" target="_blank" rel="external">https://github.com/yunjey/StarGAN</a><br>[22] SC-FEGAN: <a href="https://github.com/run-youngjoo/SC-FEGAN" target="_blank" rel="external">https://github.com/run-youngjoo/SC-FEGAN</a><br>[23] 根据文本生成图像: <a href="https://arxiv.org/abs/1711.10485" target="_blank" rel="external">https://arxiv.org/abs/1711.10485</a><br>[24] 《Everybody Dance Now》: <a href="https://carolineec.github.io/everybody_dance_now/" target="_blank" rel="external">https://carolineec.github.io/everybody_dance_now/</a><br>[25] vid2vid: <a href="https://github.com/NVIDIA/vid2vid" target="_blank" rel="external">https://github.com/NVIDIA/vid2vid</a><br>[26] 奥巴马演讲: <a href="http://grail.cs.washington.edu/projects/AudioToObama/" target="_blank" rel="external">http://grail.cs.washington.edu/projects/AudioToObama/</a><br>[27] Deepfake: <a href="https://en.wikipedia.org/wiki/Deepfake" target="_blank" rel="external">https://en.wikipedia.org/wiki/Deepfake</a><br>[28] 《深度视频肖像》: <a href="https://web.stanford.edu/~zollhoef/papers/SG2018_DeepVideo/page.html" target="_blank" rel="external">https://web.stanford.edu/~zollhoef/papers/SG2018_DeepVideo/page.html</a><br>[29] 继续发展: <a href="https://www.theverge.com/2019/6/10/18659432/deepfake-ai-fakes-tech-edit-video-by-typing-new-words" target="_blank" rel="external">https://www.theverge.com/2019/6/10/18659432/deepfake-ai-fakes-tech-edit-video-by-typing-new-words</a><br>[30] 3D 动画: <a href="https://venturebeat.com/2018/03/21/epic-games-shows-off-amazing-real-time-digital-human-with-siren-demo/" target="_blank" rel="external">https://venturebeat.com/2018/03/21/epic-games-shows-off-amazing-real-time-digital-human-with-siren-demo/</a><br>[31] MuseNet: <a href="https://openai.com/blog/musenet/" target="_blank" rel="external">https://openai.com/blog/musenet/</a><br>[32] 自动生成: <a href="https://www.theverge.com/2017/8/31/16232180/ai-fake-reviews-yelp-amazon" target="_blank" rel="external">https://www.theverge.com/2017/8/31/16232180/ai-fake-reviews-yelp-amazon</a><br>[33] 三种不同的回复: <a href="https://www.blog.google/products/gmail/save-time-with-smart-reply-in-gmail/" target="_blank" rel="external">https://www.blog.google/products/gmail/save-time-with-smart-reply-in-gmail/</a><br>[34] 另一个功能: <a href="https://ai.googleblog.com/2018/05/smart-compose-using-neural-networks-to.html" target="_blank" rel="external">https://ai.googleblog.com/2018/05/smart-compose-using-neural-networks-to.html</a></p>
<hr>
<p>严重声明：本文转载自阮一峰的博客，版权属于原作者所有。<br><a href="http://www.ruanyifeng.com/blog/2019/10/artificial-intelligenence.html" target="_blank" rel="external">原文链接</a>。</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/10/11/download-the-application-method-in-the-AppStore-of-overseas-region/" itemprop="url">
                  下载海外地区的AppStore中应用的方法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2019-10-11T16:02:00+08:00" content="2019-10-11">
              2019-10-11
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/网络工具/" itemprop="url" rel="index">
                    <span itemprop="name">网络工具</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>下载海外地区的AppStore中应用的方法</p>
<h3 id="1、官方应用直接下载"><a href="#1、官方应用直接下载" class="headerlink" title="1、官方应用直接下载"></a>1、官方应用直接下载</h3><p>如果是下载指定地区的AppStore中的应用，必须拥有此地区的AppID，然后使用此AppID登录AppStore即可随意下载免费应用。</p>
<p>如果需要下载收费的应用，又没有开通对应的支付方式（例如对应国家地区的信用卡），可以去TB上购买一个Gifts Card充值到账户余额。然后再操作。</p>
<h3 id="2、一些共享AppID的平台"><a href="#2、一些共享AppID的平台" class="headerlink" title="2、一些共享AppID的平台"></a>2、一些共享AppID的平台</h3><p>有专门做这个的网站或者论坛帖子，前几年多些。</p>
<p>还有公众号（例如：野泽科技、绝世废柴、DoMiSo），现在以公众号居多。</p>
<h3 id="3、第三方平台安装"><a href="#3、第三方平台安装" class="headerlink" title="3、第三方平台安装"></a>3、第三方平台安装</h3><p>使用爱思助手或PP助手直接连接电脑安装对应的应用。</p>
<h3 id="4、怎么获得一个美国区的AppID"><a href="#4、怎么获得一个美国区的AppID" class="headerlink" title="4、怎么获得一个美国区的AppID"></a>4、怎么获得一个美国区的AppID</h3><p>这个目前已经有很多方法，而且各种方法都在与时俱进地跟新。可以直接搜索“知乎”等，就有许多可行的方案。
　　</p>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    

  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="isunman" />
          <p class="site-author-name" itemprop="name">isunman</p>
          <p class="site-description motion-element" itemprop="description">love IT, love Movie, love Love</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">72</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>
          
          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">10</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">39</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/isunman" target="_blank">
                  
                    <i class="fa fa-globe"></i> github
                  
                </a>
              </span>
            
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
            <p class="site-author-name">Links</p>
            
              <span class="links-of-author-item">
                <a href="http://www.zhihu.com/" target="_blank">知乎</a>
              </span>
            
          
        </div>

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<div class="copyright" >
  
  &copy;  2011 - 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">isunman</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="powered-by">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>
<div class="theme-info">
<span id="busuanzi_container_site_pv">
    PV<span id="busuanzi_value_site_pv"></span> --
</span>
<span id="busuanzi_container_site_uv">
  UV<span id="busuanzi_value_site_uv"></span>
</span>
</div>


      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  


  



  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  



  



  
  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>

  
    <script type="text/javascript" src="http://cdn.staticfile.org/mathjax/2.4.0/MathJax.js"></script>
    <script type="text/javascript" src="http://cdn.staticfile.org/mathjax/2.4.0/config/TeX-AMS-MML_HTMLorMML.js"></script>
  


  
  


  

</body>
</html>
